flow Root:
    if EventFlowSystemActor.IsMyVillage():
        if event_flags_system['cPlayer:StampRallyRunningForPlayer']:
            Ftr.OpenMessageStampRackSpotName()
            Ftr.OpenMessageStampRackSpotExplain()
            EventFlowSystemActor.UIStampRallyMuseumFromStampRackHandling()
            if EventFlowSystemActor.SystemCheckNowStage('cMuseumInsect'):
                if EventFlowSystemActor.IsMyVillage():
                    if (not event_flags_system['cPlayer:OwlStampGotInsect']) and (event_flags_system['cPlayer:OwlInsectStampRally1']) and (event_flags_system['cPlayer:OwlInsectStampRally2']) and (event_flags_system['cPlayer:OwlInsectStampRally3']):
                        Player.OpenMessageWindow('TalkFtr/FTR_StampRally:301', false)
                elif (not event_flags_system['cPlayerVisit:OwlStampGotInsect']) and (event_flags_system['cPlayerVisit:OwlInsectStampRally1']) and (event_flags_system['cPlayerVisit:OwlInsectStampRally2']) and (event_flags_system['cPlayerVisit:OwlInsectStampRally3']):
                    Player.OpenMessageWindow('TalkFtr/FTR_StampRally:301', false)
            elif EventFlowSystemActor.SystemCheckNowStage('cMuseumFish'):
                if EventFlowSystemActor.IsMyVillage():
                    if (not event_flags_system['cPlayer:OwlStampGotFish']) and (event_flags_system['cPlayer:OwlFishStampRally1']) and (event_flags_system['cPlayer:OwlFishStampRally2']) and (event_flags_system['cPlayer:OwlFishStampRally3']):
                        Player.OpenMessageWindow('TalkFtr/FTR_StampRally:302', false)
                elif (not event_flags_system['cPlayerVisit:OwlStampGotFish']) and (event_flags_system['cPlayerVisit:OwlFishStampRally1']) and (event_flags_system['cPlayerVisit:OwlFishStampRally2']) and (event_flags_system['cPlayerVisit:OwlFishStampRally3']):
                    Player.OpenMessageWindow('TalkFtr/FTR_StampRally:302', false)
            elif EventFlowSystemActor.SystemCheckNowStage('cMuseumFossil'):
                if EventFlowSystemActor.IsMyVillage():
                    if (not event_flags_system['cPlayer:OwlStampGotFossil']) and (event_flags_system['cPlayer:OwlFossilStampRally1']) and (event_flags_system['cPlayer:OwlFossilStampRally2']) and (event_flags_system['cPlayer:OwlFossilStampRally3']):
                        Player.OpenMessageWindow('TalkFtr/FTR_StampRally:303', false)
                elif (not event_flags_system['cPlayerVisit:OwlStampGotFossil']) and (event_flags_system['cPlayerVisit:OwlFossilStampRally1']) and (event_flags_system['cPlayerVisit:OwlFossilStampRally2']) and (event_flags_system['cPlayerVisit:OwlFossilStampRally3']):
                    Player.OpenMessageWindow('TalkFtr/FTR_StampRally:303', false)
        else:
            Player.OpenMessageWindow('TalkFtr/FTR_StampRally:304', false)
    elif event_flags_system['cPlayerVisit:StampRallyRunningForPlayer']:
        Ftr.OpenMessageStampRackSpotName()
        Ftr.OpenMessageStampRackSpotExplain()
        EventFlowSystemActor.UIStampRallyMuseumFromStampRackHandling()
        if EventFlowSystemActor.SystemCheckNowStage('cMuseumInsect'):
            if EventFlowSystemActor.IsMyVillage():
                if (not event_flags_system['cPlayer:OwlStampGotInsect']) and (event_flags_system['cPlayer:OwlInsectStampRally1']) and (event_flags_system['cPlayer:OwlInsectStampRally2']) and (event_flags_system['cPlayer:OwlInsectStampRally3']):
                    Player.OpenMessageWindow('TalkFtr/FTR_StampRally:301', false)
            elif (not event_flags_system['cPlayerVisit:OwlStampGotInsect']) and (event_flags_system['cPlayerVisit:OwlInsectStampRally1']) and (event_flags_system['cPlayerVisit:OwlInsectStampRally2']) and (event_flags_system['cPlayerVisit:OwlInsectStampRally3']):
                Player.OpenMessageWindow('TalkFtr/FTR_StampRally:301', false)
        elif EventFlowSystemActor.SystemCheckNowStage('cMuseumFish'):
            if EventFlowSystemActor.IsMyVillage():
                if (not event_flags_system['cPlayer:OwlStampGotFish']) and (event_flags_system['cPlayer:OwlFishStampRally1']) and (event_flags_system['cPlayer:OwlFishStampRally2']) and (event_flags_system['cPlayer:OwlFishStampRally3']):
                    Player.OpenMessageWindow('TalkFtr/FTR_StampRally:302', false)
            elif (not event_flags_system['cPlayerVisit:OwlStampGotFish']) and (event_flags_system['cPlayerVisit:OwlFishStampRally1']) and (event_flags_system['cPlayerVisit:OwlFishStampRally2']) and (event_flags_system['cPlayerVisit:OwlFishStampRally3']):
                Player.OpenMessageWindow('TalkFtr/FTR_StampRally:302', false)
        elif EventFlowSystemActor.SystemCheckNowStage('cMuseumFossil'):
            if EventFlowSystemActor.IsMyVillage():
                if (not event_flags_system['cPlayer:OwlStampGotFossil']) and (event_flags_system['cPlayer:OwlFossilStampRally1']) and (event_flags_system['cPlayer:OwlFossilStampRally2']) and (event_flags_system['cPlayer:OwlFossilStampRally3']):
                    Player.OpenMessageWindow('TalkFtr/FTR_StampRally:303', false)
            elif (not event_flags_system['cPlayerVisit:OwlStampGotFossil']) and (event_flags_system['cPlayerVisit:OwlFossilStampRally1']) and (event_flags_system['cPlayerVisit:OwlFossilStampRally2']) and (event_flags_system['cPlayerVisit:OwlFossilStampRally3']):
                Player.OpenMessageWindow('TalkFtr/FTR_StampRally:303', false)
    else:
        Player.OpenMessageWindow('TalkFtr/FTR_StampRally:304', false)
    return

