flow MoveMyHouseOngoing:
    EventFlowSystemActor.NpcEventItemSet(5358, 0, 'cTalk', 'ItemPrice')
    if event_flags_system['cLand:RcoMoveReservedAnyone'] == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:023', false)
    else:
        EventFlowSystemActor.UIMoneyAppear()
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:020', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:021', false)
            EventFlowSystemActor.DeleteTargetItem(5358, 1, false)
            EventFlowSystemActor.BellCountDown(30000, False)
            event_flags_system['cPlayer:RcoMoveHouseReserved'] = false
            event_flags_system['cLand:RcoMoveReservedAnyone'] = 0
            event_flags_system['cLand:RcoMoveReservedKind'] = 0
            event_flags_system['cPlayer:RcoMoveSomeBuiding'] = false
            EventFlowSystemActor.StructureMoveSaveIndex(2)
            EventFlowSystemActor.UIMoneyDisappear()
        else:
            EventFlowSystemActor.UIMoneyDisappear()
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:022', false)
    return

flow Root:
    run SNPC_rco_10_Common_Move::MoveBuildStateChk
    run SNPC_rco_10_Common_Move::MoveBuildKindChk
    if subflow_results[0] == 0:
        EventFlowSystemActor.UIMoneyAppear()
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:013', false)
        if EventFlowSystemActor.GeneralTalkChoice2() != 0:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:014', false)
            EventFlowSystemActor.UIMoneyDisappear()
            if EventFlowSystemActor.OfficeLevel() == ResServiceBuilding:
                run SNPC_rco_00_Common::Rco_Office_CmnSelAgain
        elif not EventFlowSystemActor.HasBellCount(30000):
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:015', false)
            EventFlowSystemActor.UIMoneyDisappear()
        elif EventFlowSystemActor.ShoppingCapacity(5358, 'cItemName'):
            EventFlowSystemActor.BellCountDown(-30000, False)
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:017', false)
            EventFlowSystemActor.SetItemToPocket(5358, 1)
            EventFlowSystemActor.StructureMoveSaveIndex(0)
            EventFlowSystemActor.NpcEventItemSet(5358, 0, 'cTalk', 'ItemPrice')
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:018', false)
            event_flags_system['cPlayer:RcoMoveHouseReserved'] = true
            event_flags_system['cLand:RcoMoveReservedAnyone'] = 1
            event_flags_system['cLand:RcoMoveReservedKind'] = 1
            event_flags_system['cPlayer:RcoMoveSomeBuiding'] = true
            EventFlowSystemActor.UIMoneyDisappear()
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:016', false)
            EventFlowSystemActor.UIMoneyDisappear()
    else:
        run SNPC_rco_10_Common_Move::MoveBuildError
    return

