flow Init:
    if (event_flags_system['cLandTemp:IsFirstPrologue']) and (event_flags_system['cLand:SetPrologueBonfire']):
        MainNpc.NpcRegistAIBlackBoard('PrologueStep', 2)
    else:
        MainNpc.NpcRegistAIBlackBoard('PrologueStep', 0)
    MainNpc.NpcAISetting(1, true)
    MainNpc.NpcRegistAIBlackBoard('HasTent', 0)
    MainNpc.NpcRegistAIBlackBoard('IsMove', 0)
    MainNpc.NpcRegistAIBlackBoard('PreCampfire', 0)
    MainNpc.NpcRegistAIBlackBoard('Visible', 1)
    MainNpc.NpcDisableServiceMotion()
    MainNpc.ServiceMotionControl(false)
    return

flow Root:
    if MainNpc.NpcBlackBoard('Visible', 1):
        run Root_Common
    else:
        MainNpc.NpcChangeAIState('cInvisible', '', '', '', false, true)
    return

flow Root_2ndStep:
    run Event6
    return

flow Root_Common:
    if MainNpc.NpcBlackBoard('PrologueStep', 1):
entrypoint Event6:
        if MainNpc.NpcBlackBoard('PrologueStep', 2):
            MainNpc.NpcAISetting(8, true)
            MainNpc.NpcAISetting(6, false)
            if not MainNpc.NpcBlackBoard('PreCampfire', 1):
                if not event_flags_system['cLandTemp:PrologueStartedCampfire']:
                    MainNpc.NpcChangeTurnDefaultState('cTurn', '', 'Root', 'TalkEventFlowName', true, false, true, 1, 0.0, '')
                elif MainNpc.NpcCheckStateSelectTiming('cTalkEnd'):
                    MainNpc.NpcChangeTurnDefaultState('cTurn', '', 'Root', 'TalkEventFlowName', false, false, false, 1, 0.0, '')
                else:
                    MainNpc.NpcChangeAIStateCstm('TalkEventFlowName', 'Root', 2, 'Angle:0')
            elif entry_variables['Type'] == 0:
                MainNpc.NpcAISetting(8, false)
                MainNpc.NpcChangeAIStateCstm('TalkEventFlowName', 'Root', 4, '')
            elif MainNpc.NpcCheckStateSelectTiming('cTalkEnd'):
                MainNpc.NpcChangeTurnDefaultState('cTurn', '', 'Root', 'TalkEventFlowName', false, false, false, 1, 'PreCampfireAngle', '')
            else:
                MainNpc.NpcChangeWaitState('cWait', 'Root', 'TalkEventFlowName', '', false, true, 0, true, 'PreCampfireAS')
        else:
            MainNpc.NpcAISetting(6, true)
            if MainNpc.NpcBlackBoard('IsMove', 1):
                MainNpc.NpcAddBlackBoard('PrologueStep', 1)
                MainNpc.NpcChangeGoToDestinationState('cGoToDestination', 'Root', 'TalkEventFlowName', '', false, true, 1, 'OffsetX', 'OffsetZ')
            else:
                MainNpc.NpcSetAIBlackBoard('IsMove', 1)
                MainNpc.NpcChangeWaitState('cWait', 'Root', 'TalkEventFlowName', '', true, true, 'WaitFrame', true, '')
    else:
        MainNpc.NpcAddBlackBoard('PrologueStep', 1)
        MainNpc.NpcChangeWaitState('cWait', 'Root', 'TalkEventFlowName', '', true, true, 0, true, '')
    return

