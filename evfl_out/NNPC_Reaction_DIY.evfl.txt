flow Root:
    if MainNpc.IsInTheActOfDIY():
        run NNPC_FreeH_Progress::Conceal_NpcHouseBuilt
        MainNpc.SetItemName(0, 16, 0)
        if not event_flag_npc['cNpcMemory:GotRecipeorMaterial']:
            if event_flag_npc['cNpcMemory:GotMaterialItemFull']:
                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:021', false)
                MainNpc.NpcSetRewardRecipe(65534, true)
                MainNpc.SetDeliveryItem(1, true)
                if EventFlowSystemActor.ShoppingCapacity(65534, 'cNpcTrade'):
                    MainNpc.NpcDelivery('Default', 1)
                    if MainNpc.IsNpcDIYRecipeCollected():
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:020', false)
                    else:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:018', false)
                    event_flags_npc['cNpcMemory:GotRecipeorMaterial'] = true
                    event_flags_system['cPlayerTemp:GotRecipeorMaterial'] = true
                    event_flags_npc['cNpcMemory:TalkDIY'] = true
                    EventFlowSystemActor.ExitFlowchart()
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:010', false)
                    event_flags_npc['cNpcMemory:GotMaterialItemFull'] = true
                    EventFlowSystemActor.ExitFlowchart()
            else:
                fEvent84 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
                if fEvent84 == 1:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:015', false)
                elif fEvent84 == 2:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:016', false)
                elif fEvent84 == 0:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:001', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:002', false)
                    if MainNpc.IsNpcDIYRecipeCollected():
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:008', false)
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:009', false)
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:019', false)
                        MainNpc.NpcSetRewardRecipe(65534, true)
                        MainNpc.SetDeliveryItem(1, true)
                        if EventFlowSystemActor.ShoppingCapacity(65534, 'cNpcTrade'):
                            MainNpc.NpcDelivery('Default', 1)
                            if MainNpc.IsNpcDIYRecipeCollected():
                                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:020', false)
                            else:
                                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:018', false)
                            event_flags_npc['cNpcMemory:GotRecipeorMaterial'] = true
                            event_flags_system['cPlayerTemp:GotRecipeorMaterial'] = true
                            event_flags_npc['cNpcMemory:TalkDIY'] = true
                            EventFlowSystemActor.ExitFlowchart()
                        else:
                            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:010', false)
                            event_flags_npc['cNpcMemory:GotMaterialItemFull'] = true
                            EventFlowSystemActor.ExitFlowchart()
                    else:
                        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:003', false)
                        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:017', false)
                            MainNpc.NpcSetRewardRecipe(65534, true)
                            MainNpc.SetDeliveryItem(1, true)
                            if EventFlowSystemActor.ShoppingCapacity(65534, 'cNpcTrade'):
                                MainNpc.NpcDelivery('Default', 1)
                                if MainNpc.IsNpcDIYRecipeCollected():
                                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:020', false)
                                else:
                                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:018', false)
                                event_flags_npc['cNpcMemory:GotRecipeorMaterial'] = true
                                event_flags_system['cPlayerTemp:GotRecipeorMaterial'] = true
                                event_flags_npc['cNpcMemory:TalkDIY'] = true
                                EventFlowSystemActor.ExitFlowchart()
                            else:
                                MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:010', false)
                                event_flags_npc['cNpcMemory:GotMaterialItemFull'] = true
                                EventFlowSystemActor.ExitFlowchart()
                        else:
                            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:007', false)
                            EventFlowSystemActor.ExitFlowchart()
                else:
                    MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/React/BO_React_DIY:007', false)
                    EventFlowSystemActor.ExitFlowchart()
    return

