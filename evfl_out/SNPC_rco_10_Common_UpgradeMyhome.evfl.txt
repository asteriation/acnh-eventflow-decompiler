flow HHA_1st_BuildCelebration:
    fEvent36 = EventFlowSystemActor.RandomChoice3(3)
    if fEvent36 == 0:
        MainNpc.NpcSetRewardRecipe(7134, false)
    elif fEvent36 == 1:
        MainNpc.NpcSetRewardRecipe(7133, false)
    elif fEvent36 == 2:
        MainNpc.NpcSetRewardRecipe(3438, false)
    EventFlowSystemActor.SystemMailSend('cHHA', 'MAIL_SP_HHA_BuildCelebration', 'cFastTomorrow', 'cReward', 'cNone', false, 1)
    return

flow RcoCmnProcessUpgradeMyhome:
    event_flags_system['cPlayer:RcoOrderedHouseBuilt'] = true
    event_flags_system['cPlayer:RcoHeardRemodel1'] = false
    fEvent9 = EventFlowSystemActor.PlayerHouseLevel()
    if fEvent9 == PlacedTent:
        event_flags_system['cHouse:HouseOrder1'] = true
        event_flags_system['cPlayer:NnpcFinishHintTalk'] = true
        run HHA_1st_BuildCelebration
    elif fEvent9 == BaseHouse:
        event_flags_system['cHouse:HouseOrder2'] = true
    elif fEvent9 == HouseExpansion1:
        event_flags_system['cHouse:HouseOrder3'] = true
    elif fEvent9 == BackRoom:
        event_flags_system['cHouse:HouseOrder4'] = true
    elif fEvent9 == LeftRoom:
        event_flags_system['cHouse:HouseOrder5'] = true
    elif fEvent9 == RightRoom:
        event_flags_system['cHouse:HouseOrder6'] = true
    elif fEvent9 == SecondFloor:
        event_flags_system['cHouse:HouseOrder7'] = true
    return

flow Rco_Cmn_UpgradeHouseSel:
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        fEvent19 = EventFlowSystemActor.PlayerHouseLevel()
        if fEvent19 == PlacedTent:
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:202', false)
            run SNPC_rco_02_SelRoofColor::Root
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:209', false)
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:209_01', false)
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:209_02', true)
            run Demo_Common_PhoneCall::SendingDataOneWay
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:209_03', false)
            MainNpc.SmartPhone(1)
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:209_04', false)
            event_flags_system['cPlayer:MainmenuRndDailyQuest'] = true
            event_flags_system['cPlayer:PlayerSonkatsuQuestEnable'] = true
            event_flags_system['cPlayer:Mobile1stBoot_MilageProgram'] = true
            if (EventFlowSystemActor.TermEventNow('EarthDay', false)) and (not event_flags_system['cPlayer:MailSendFlag_EarthDayNotice']):
                EventFlowSystemActor.SystemMailSend('cRco', 'MAIL_SNpc_rco', 'cFastToday', 'cReward', 'cNone', false, 6)
                event_flags_system['cPlayer:MailSendFlag_EarthDayNotice'] = true
            run RcoCmnProcessUpgradeMyhome
        elif fEvent19 in (BaseHouse, BackRoom):
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:251', false)
            run SNPC_rco_02_SelRoofColor::Root
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:252', false)
            run RcoCmnProcessUpgradeMyhome
        elif fEvent19 in (HouseExpansion1, LeftRoom, RightRoom, SecondFloor):
            MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:103', false)
            run RcoCmnProcessUpgradeMyhome
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:102', false)
        if EventFlowSystemActor.OfficeLevel() == ResServiceBuilding:
            run SNPC_rco_00_Common::Rco_Office_CmnSelAgain
    return

flow Root:
    fEvent1 = EventFlowSystemActor.PlayerHouseLevel()
    if fEvent1 == PlacedTent:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:201', false)
        run Rco_Cmn_UpgradeHouseSel
    elif fEvent1 == BaseHouse:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:211', false)
        run Rco_Cmn_UpgradeHouseSel
    elif fEvent1 == HouseExpansion1:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:212', false)
        run Rco_Cmn_UpgradeHouseSel
    elif fEvent1 == BackRoom:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:213', false)
        run Rco_Cmn_UpgradeHouseSel
    elif fEvent1 == LeftRoom:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:214', false)
        run Rco_Cmn_UpgradeHouseSel
    elif fEvent1 == RightRoom:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:215', false)
        run Rco_Cmn_UpgradeHouseSel
    elif fEvent1 == SecondFloor:
        MainNpc.OpenMessageWindow('TalkSNpc/rco/SP_rco_00_Common:216', false)
        run Rco_Cmn_UpgradeHouseSel
    return

