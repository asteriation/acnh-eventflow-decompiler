flow Museum:
    MainNpc.NpcAIDefaultSetting(1)
    fEvent20 = MainNpc.FacilityNpcState()
    if fEvent20 == 1:
        MainNpc.NpcAISetting(2, false)
        MainNpc.NpcAISetting(3, false)
        MainNpc.NpcChangeAIState('cWatch', 'NNPC_Reaction_Watching', 'React_Watcing', '', true, true)
    elif fEvent20 == 0:
        if (MainNpc.NpcCheckStateSelectTiming('cTalkEnd')) and (event_flag_npc['cNpcTemp:TalkEndWait']):
            MainNpc.NpcChangeWaitState('cWait', '', 'NNPC_Spot_Museum', '', true, false, 30, true, '')
            event_flags_npc['cNpcTemp:TalkEndWait'] = false
        else:
            MainNpc.NpcChangeAIState('cMoveToWatchPoint', 'NNPC_Spot_Museum', '', '', true, true)
    elif fEvent20 == 2:
        if (MainNpc.NpcCheckStateSelectTiming('cTalkEnd')) and (event_flag_npc['cNpcTemp:TalkEndWait']):
            MainNpc.NpcChangeWaitState('cWait', '', 'NNPC_Spot_Museum', '', true, false, 30, true, '')
            event_flags_npc['cNpcTemp:TalkEndWait'] = false
        else:
            MainNpc.NpcChangeAIState('cFacilityWander', 'NNPC_Spot_Museum', '', '', true, true)
    return

flow Store:
    MainNpc.NpcAIDefaultSetting(1)
    fEvent29 = MainNpc.FacilityNpcState()
    if fEvent29 == 1:
        MainNpc.NpcAISetting(2, false)
        MainNpc.NpcAISetting(3, false)
        MainNpc.NpcChangeAIState('cWatch', 'NNPC_Reaction_Shopping', 'React_Shopping', '', true, true)
    elif fEvent29 == 0:
        if (MainNpc.NpcCheckStateSelectTiming('cTalkEnd')) and (event_flag_npc['cNpcTemp:TalkEndWait']):
            MainNpc.NpcChangeWaitState('cWait', '', 'NNPC_Spot_Store', '', true, false, 30, true, '')
            event_flags_npc['cNpcTemp:TalkEndWait'] = false
        else:
            MainNpc.NpcChangeAIState('cMoveToWatchPoint', 'NNPC_Spot_Store', '', '', true, true)
    elif fEvent29 == 2:
        if (MainNpc.NpcCheckStateSelectTiming('cTalkEnd')) and (event_flag_npc['cNpcTemp:TalkEndWait']):
            MainNpc.NpcChangeWaitState('cWait', '', 'NNPC_Spot_Store', '', true, false, 30, true, '')
            event_flags_npc['cNpcTemp:TalkEndWait'] = false
        else:
            MainNpc.NpcChangeAIState('cFacilityWander', 'NNPC_Spot_Store', '', '', true, true)
    return

flow Tailor:
    MainNpc.NpcAIDefaultSetting(1)
    fEvent27 = MainNpc.FacilityNpcState()
    if fEvent27 == 1:
        MainNpc.NpcAISetting(2, false)
        MainNpc.NpcAISetting(3, false)
        MainNpc.NpcChangeAIState('cWatch', 'NNPC_Reaction_Shopping', 'React_Shopping', '', true, true)
    elif fEvent27 == 0:
        if (MainNpc.NpcCheckStateSelectTiming('cTalkEnd')) and (event_flag_npc['cNpcTemp:TalkEndWait']):
            MainNpc.NpcChangeWaitState('cWait', '', 'NNPC_Spot_Tailor', '', true, false, 30, true, '')
            event_flags_npc['cNpcTemp:TalkEndWait'] = false
        else:
            MainNpc.NpcChangeAIState('cMoveToWatchPoint', 'NNPC_Spot_Tailor', '', '', true, true)
    elif fEvent27 == 2:
        if (MainNpc.NpcCheckStateSelectTiming('cTalkEnd')) and (event_flag_npc['cNpcTemp:TalkEndWait']):
            MainNpc.NpcChangeWaitState('cWait', '', 'NNPC_Spot_Tailor', '', true, false, 30, true, '')
            event_flags_npc['cNpcTemp:TalkEndWait'] = false
        else:
            MainNpc.NpcChangeAIState('cFacilityWander', 'NNPC_Spot_Tailor', '', '', true, true)
    return

flow Root:
    if MainNpc.IsTargetNpcHouse():
        run AI_NPC_Indoor::Root
    else:
        MainNpc.SetIsStartNeedActivity('cOff')
        if EventFlowSystemActor.SystemCheckNowStage('cMametubu'):
            run Store
        elif EventFlowSystemActor.SystemCheckNowStage('cTailor'):
            run Tailor
        else:
            run Museum
    return

flow Init:
    run AI_NPC_Indoor::BBRegist
    return

