flow Root:
    event_flags_system['cPlayerTemp:OwlWokeHimUp'] = false
    if EventFlowSystemActor.IsMyVillage():
entrypoint Event28:
        fEvent28 = EventFlowSystemActor.MuseumLevel()
        if fEvent28 == BlathersTent:
            run SNPC_owl_10_Tent::Root
        elif fEvent28 in (BlathersMuseumNoArt, BlathersMuseumArt):
            if MainNpc.NpcBlackBoard('IsSleep', 1):
                run Asleep
            else:
entrypoint Event35:
                if not event_flags_system['cPlayer:OwlFinished1stTalk']:
                    run SNPC_owl_21_Museum_FirstTimeTalk::Root
                elif event_flags_system['cPlayer:FutaTalkedInMuseumToday']:
                    run SNPC_owl_23_Museum_DiveFish::ChkCompReport
                    run SNPC_owl_24_Museum_StampRally::From2ndTime
                    run SNPC_owl_22_Museum_RenualQuest::BeforeRenualQuest
                    if EventFlowSystemActor.MuseumComplete():
                        if event_flags_system['cPlayer:FutaExplanationDonationComp']:
                            run SNPC_owl_22_Museum_RenualQuest::Root
                        else:
                            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:014', false)
                            event_flags_system['cPlayer:FutaExplanationDonationComp'] = true
                            run SNPC_owl_00_Common::Comp_Direct
                    elif not event_flags_system['cLand:OwlFoundFossil']:
                        run SNPC_owl_10_Tent::Sel_NoFoundFossil
                    elif not event_flags_system['cPlayer:OwlShowFossilMyself']:
                        event_flags_system['cPlayer:OwlShowFossilMyself'] = true
                        event_flags_system['cPlayer:OwlMultiDonateExplain'] = true
                        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:052', false)
                    elif not event_flags_system['cPlayer:OwlMultiDonateExplain']:
                        event_flags_system['cPlayer:OwlMultiDonateExplain'] = true
                        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:051', false)
                    elif EventFlowSystemActor.NetHasVisitor():
                        run NoTopic
                    else:
                        run SNPC_owl_23_Museum_DiveFish::Root
                else:
entrypoint Event32:
                    event_flags_system['cPlayer:FutaTalkedInMuseumToday'] = true
                    fEvent84 = EventFlowSystemActor.MuseumLevel()
                    if fEvent84 in (BlathersNotMovedIn, BlathersTent, BlathersMuseumNoArt):
                        if event_flags_system['cPlayer:Owl1stTalkMuseum1']:
                            run SNPC_owl_00_Common::CmnTodayTalk1st
                        else:
                            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:001', false)
                            if event_flags_system['cLand:Museum2BuiltToday']:
                                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:001_01', false)
                            else:
                                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:001_02', false)
                            if event_flags_system['cPlayer:OwlDonationDone']:
                                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:002_01', false)
                            else:
                                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:002_02', false)
                            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:003', false)
                            if not event_flags_system['cLand:OwlFoundFossil']:
                                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:004_02', false)
                            elif event_flags_system['cPlayer:OwlShowFossilMyself']:
                                if EventFlowSystemActor.MuseumComplete():
                                    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:004_04', false)
                                    event_flags_system['cPlayer:FutaExplanationDonationComp'] = true
                                else:
                                    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:004_01', false)
                                event_flags_system['cPlayer:OwlMultiDonateExplain'] = true
                            else:
                                MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:004_03', false)
                                event_flags_system['cPlayer:OwlShowFossilMyself'] = true
                                if EventFlowSystemActor.MuseumComplete():
                                    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:004_04', false)
                                    event_flags_system['cPlayer:FutaExplanationDonationComp'] = true
                                else:
                                    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_11_Museum1stTalk:004_01', false)
                                event_flags_system['cPlayer:OwlMultiDonateExplain'] = true
                            event_flags_system['cPlayer:Owl1stTalkMuseum1'] = true
                    elif fEvent84 == BlathersMuseumArt:
                        if event_flags_system['cPlayer:Owl1stTalkMuseum2']:
                            run SNPC_owl_00_Common::CmnTodayTalk1st
                        else:
                            run SNPC_owl_22_Museum_RenualQuest::AfterRenualQuest
    else:
        run SNPC_owl_90_OtherTown::Root
    return

flow Asleep:
    event_flags_system['cPlayerTemp:OwlWokeHimUp'] = true
    MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:001', false)
    MainNpc.NpcSetAIBlackBoard('IsSleep', 0)
    MainNpc.SetDefaultWaitAs('cDefault')
    MainNpc.TurnBody(10, 0.0)
    if event_flags_system['cPlayer:FutaTalkedWhenAsleep']:
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:003', false)
        fEvent40 = EventFlowSystemActor.MuseumLevel()
        if fEvent40 == BlathersTent:
            run SNPC_owl_10_Tent::Root
        elif fEvent40 in (BlathersMuseumNoArt, BlathersMuseumArt):
            run OwlTalkAfterWakeup
            event_flags_system['cPlayerTemp:OwlWokeHimUp'] = false
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:002', false)
        event_flags_system['cPlayer:FutaTalkedWhenAsleep'] = true
        event_flags_system['cPlayerTemp:OwlWokeHimUp'] = false
        run Owl_Talk_CommonTalk
    return

flow Owl_Talk_CommonTalk:
    run Event28
    return

flow Owl_Talk_Today1stChk:
    run Event32
    return

flow OwlTalkAfterWakeup:
    run Event35
    return

flow NoTopic:
    if EventFlowSystemActor.MuseumComplete():
        if event_flags_system['cPlayerTemp:OwlWokeHimUp']:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:016', false)
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:018', false)
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:012', false)
        run SNPC_owl_00_Common::Comp_Direct
    elif event_flags_system['cPlayerTemp:OwlWokeHimUp']:
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:016', false)
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:017', false)
        run sub_Event31
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/owl/SP_owl_00_Common:013', false)
        run sub_Event31
    return

flow sub_Event31:
    run SNPC_owl_00_Common::Select4_Direct

