flow Root:
    if event_flags_system['cLandTemp:JuneBrideCeremonyDemoAfterNow']:
        run Root_PartyEnd
    else:
        Player.OpenMessageWindow('TalkSys/SYS_GEvent:001', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            EventFlowSystemActor.CalcJuneBrideScore()
            if not EventFlowSystemActor.JuneBrideScoreCheck('cFurnitureNum', 1):
                Player.OpenMessageWindow('TalkSys/SYS_GEvent:003', false)
            elif not EventFlowSystemActor.CheckCalledNpcNumNormal(1):
                Player.OpenMessageWindow('TalkSys/SYS_GEvent:004', false)
            elif EventFlowSystemActor.AlwAlpIsOnBedJuneBride():
                Player.OpenMessageWindow('TalkSys/SYS_GEvent:005', false)
            else:
                run PartyStart_Wipe
    return

flow Root_PartyEnd:
    Player.OpenMessageWindow('TalkSys/SYS_GEvent:002', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run PartyEnd_Wipe
    return

flow PartyEnd_Wipe:
    EventFlowSystemActor.AfterWeddingBGMEnd()
    if event_flags_system['cPlayer:AlwJuneBrideDayCount'] >= 6:
        event_flags_system['cPlayer:JuneBridePlacementDataClearFlag'] = true
        event_flags_system['cLandTemp:JuneBrideCeremonyDemoAfterNow'] = false
        event_flags_system['cLandTemp:RemakeJuneBrideTalkTimeAfterNow'] = true
        EventFlowSystemActor.MessageSuspend()
        EventFlowSystemActor.SystemRequestChangeStage('cJuneBrideStudio', 'cHeartWipe', 'cHeartWipe', 'cBlack', 1.0, 1.0)
    else:
        EventFlowSystemActor.MessageSuspend()
        EventFlowSystemActor.NextLPFadeOff()
        EventFlowSystemActor.SystemBGMVolumeFadeOut(3, 5.0, 0.0)
        event_flags_system['cPlayer:JuneBridePlacementDataClearFlag'] = true
        EventFlowSystemActor.SystemRequestChangeStage('cPhotoStudioIslandHouse', 'cCircle', 'cNormalFader', 'cBlack', 1.0, 0.125)
    return

flow PartyStart_Wipe:
    run SNPC_alw_01_Studio::Alw_DayChk
    EventFlowSystemActor.CalcJuneBrideScore()
    run SNPC_alw_01_Studio::Alw_ScoreCount
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.WeddingBGMStart()
    event_flags_system['cPlayer:AlwJuneBrideBalloonFlag'] = false
    EventFlowSystemActor.UIGuideBalloonWeddingParty(0)
    EventFlowSystemActor.SystemRequestChangeStage('cJuneBrideDemo', 'cHeartWipe', 'cHeartWipe', 'cBlack', 1.0, 1.0)
    return

