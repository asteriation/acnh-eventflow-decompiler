flow PostOpenNFP:
    if not event_flags_system['cPlayerTemp:PhotoStudioAmiiboInfoDone']:
        EventFlowSystemActor.UIAmiiboPreviousNoticeGuideCreate()
        event_flags_system['cPlayerTemp:PhotoStudioAmiiboInfoDone'] = true
    if not EventFlowSystemActor.NfcDisabled():
        EventFlowSystemActor.CheckNfpController('NpadId')
        if (entry_variables['NpadId'] >= 0) and (not event_flags_system['cPlayerTemp:NFPControllerAssertDone']):
            EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1602', false)
            event_flags_system['cPlayerTemp:NFPControllerAssertDone'] = true
    elif not event_flags_system['cPlayerTemp:NFPFlightModeAssertDone']:
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1612', false)
        event_flags_system['cPlayerTemp:NFPFlightModeAssertDone'] = true
    return

flow PostLoadNFP:
    if not EventFlowSystemActor.HasSpaceCreateNpc():
        EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1608', false)
    elif EventFlowSystemActor.CalledNpcNum(10):
        EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1607', false)
    elif not EventFlowSystemActor.IsAcceptableAmiibo():
        EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1614', false)
    elif EventFlowSystemActor.CheckAmiiboNPC('cRcmAndRct'):
        EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1609', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            EventFlowSystemActor.ChangeAmiiboNPC('cRcm')
            run sub_grp!Event47
        else:
            EventFlowSystemActor.ChangeAmiiboNPC('cRct')
            run sub_grp!Event47
    elif EventFlowSystemActor.CheckAmiiboNPC('cVillager'):
        run PhotoStudioCallVillager
    else:
        run sub_grp!Event47
    return

flow LoadNFP_Error:
    EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
    fEvent0 = EventFlowSystemActor.NfpErrorType()
    if fEvent0 == 0:
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1614', false)
    elif fEvent0 == 1:
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1613', false)
    elif fEvent0 == 2:
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1601', true)
    return

flow ChkPhoneCallPrintService:
    if not EventFlowSystemActor.IsCallableAmiiboNpc('cPhotoStudio'):
entrypoint Event13:
        if not event_flags_system['cPlayer:PhotoStudioUseCantCallAmiibo']:
            event_flags_system['cPlayer:StandByPhoneCallPrintService'] = true
            event_flags_system['cPlayer:StandByGameStartPhoneCall'] = true
            event_flags_system['cPlayer:PhotoStudioUseCantCallAmiibo'] = true
    elif not event_flags_system['cPlayer:TanuportAmiiboBromideUnlock']:
        event_flags_system['cPlayer:StandByPhoneCallPrintService'] = true
        event_flags_system['cPlayer:StandByGameStartPhoneCall'] = true
    return

flow PhotoStudioCallVillager:
    run ChkPhoneCall_Villager
    EventFlowSystemActor.SetAmiiboReadOn()
    EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
    EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1610', false)
    return

flow ChkPhoneCall_Villager:
    run Event13
    return

flow sub_grp!Event47:
    if EventFlowSystemActor.IsAlreadyCalledAmiiboNpc('cPhotoStudio'):
        EventFlowSystemActor.SetTagFromSystem(0, 'cAmiiboCallNpcNameToDialog', 'cDegit', '', 0)
        EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
        EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1605', true)
    else:
        run ChkPhoneCallPrintService
        if EventFlowSystemActor.IsCallableAmiiboNpc('cPhotoStudio'):
            EventFlowSystemActor.SetAmiiboReadOn()
            EventFlowSystemActor.CreateSelectNpc(true)
        else:
            EventFlowSystemActor.SetAmiiboReadOn()
            EventFlowSystemActor.SetTagFromSystem(0, 'cAmiiboCallNpcNameToDialog', 'cDegit', '', 0)
            EventFlowSystemActor.UIPhotoIslandInteriorEditGuideOff()
            EventFlowSystemActor.OpenMessageWindow('Dialog/DIALOG_Msg:1606', true)

