flow Root:
    if EventFlowSystemActor.SystemCheckNowStage('cTalkingPlayerHouse'):
        run StartAudio
    elif EventFlowSystemActor.SystemCheckNowStage('cPhotoStudioIsland'):
        run StartAudio
    elif not ((EventFlowSystemActor.SystemCheckNowStage('cField')) and (EventFlowSystemActor.IsMyVillage())):
        run sub_grp!Event12
    elif not EventFlowSystemActor.IsPlayingAudioMusic():
        run StartAudio
    elif EventFlowSystemActor.IsLastControlAudioMusic():
        run StartAudio
    else:
        EventFlowSystemActor.SetTagFromSystem(0, 'cLastAudioControlVillager', 'cDegit', '', 0)
        EventFlowSystemActor.SetTagFromSystem(1, 'cPlayingAudioMusicName', 'cDegit', '', 0)
        Player.OpenMessageWindow('TalkFtr/FTR_Audio:001', true)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            run StartAudio
    return

flow StartAudio:
    EventFlowSystemActor.UIAudioHandling()

flow sub_grp!Event12:
    if EventFlowSystemActor.IsPlayingAudioMusic():
        EventFlowSystemActor.SetTagFromSystem(0, 'cPlayingAudioMusicName', 'cDegit', '', 0)
        Player.OpenMessageWindow('TalkFtr/FTR_Audio:002', false)
    else:
        Player.OpenMessageWindow('TalkFtr/FTR_Audio:003', false)

