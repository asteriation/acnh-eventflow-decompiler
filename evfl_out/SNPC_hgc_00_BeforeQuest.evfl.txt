flow Hgc_Get_Sample:
    MainNpc.SetDeliveryItem(1, true)
    if not MainNpc.NpcIsEquipedHandTool(0):
        MainNpc.NpcChangeHandTool(false, 'cNone', 65534)
    MainNpc.NpcDelivery('"Default"', 1)
    event_flags_system['cPlayer:KotonoGotSampleFlag'] = true
    MainNpc.SetItemName(0, 1, 0)
    fEvent35 = subflow_results[0]
    if fEvent35 == 1:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:013', false)
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:015', true)
    elif fEvent35 == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:016', false)
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:018', true)
    elif fEvent35 == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:010', false)
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:012', true)
    if not MainNpc.NpcIsEquipedHandTool(0):
        MainNpc.NpcChangeHandTool(false, 'cNone', 7285)
    return

flow Hgc_Quest_Accept:
    fEvent3 = subflow_results[0]
    if fEvent3 == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:008', false)
    elif fEvent3 == 1:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:007', false)
    elif fEvent3 == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:005', false)
    MainNpc.HgcThemeMessage()
    MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:009', false)
    MainNpc.DecideEventReward('cKotonoHint')
    MainNpc.SetItemName(0, 1, 0)
    if EventFlowSystemActor.ShoppingCapacity(65534, 'cReward'):
        run Hgc_Get_Sample
    else:
        fEvent27 = subflow_results[0]
        if fEvent27 == 0:
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:011', false)
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:012', true)
        elif fEvent27 == 2:
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:017', false)
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:018', true)
        elif fEvent27 == 1:
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:014', false)
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:015', true)
    event_flags_system['cPlayer:KotonoQuestStartFlag'] = true
    MainNpc.HgcSetOutfit()
    return

flow Root:
    if not event_flags_system['cPlayer:KotonoTalkBeforeFlag']:
        event_flags_system['cPlayer:KotonoTalkBeforeFlag'] = true
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:001', false)
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:003', false)
        run sub_grp!Event6
    elif subflow_results[0] == 0:
        if event_flags_system['cPlayer:KotonoQuestRefuseFlag']:
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:004', false)
            run sub_grp!Event6
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:002', false)
            MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:003', false)
            run sub_grp!Event6
    else:
        run Hgc_Quest_Accept
    return

flow sub_grp!Event6:
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run Hgc_Quest_Accept
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/hgc/SP_hgc:006', false)
        event_flags_system['cPlayer:KotonoQuestRefuseFlag'] = true

