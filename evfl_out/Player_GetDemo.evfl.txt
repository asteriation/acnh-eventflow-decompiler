flow FullItem:
    run Event24
    return

flow FullItem_Plant:
    Player.OpenMessageWindow('TalkSys/SYS_Player:017', true)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run Event59
    return

flow GetFish_NomalSeq:
    run Event6
    return

flow GetRecipe_PitFallSeed_FullItem:
    Player.OpenMessageWindow('TalkSys/SYS_Player:003_01', false)
    run Event18
    return

flow Get_CatchFishCompleteDemo:
    run Player_GetDemo_BeyDaily::BeyDailyQ_GetFish
    if (Player.PlayerGetDemoCollectStatus('cCompleteThisTime')) or ((Player.PlayerGetDemoCollectStatus('cCompleteAlready')) and (not event_flags_system['cPlayer:CompleteFish'])):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Fish:002', false)
        Player.PlayerPlayCompleteAnimation()
        Player.OpenMessageWindow('TalkSys/SYS_Get_Fish:003', false)
        Player.PlayerWaitAsFinish()
        event_flags_system['cPlayer:CompleteFish'] = true
    run sub_tm!Get_CatchFishCompleteDemo

flow Get_CatchInsectCompleteDemo:
    if (Player.PlayerGetDemoCollectStatus('cCompleteThisTime')) or ((Player.PlayerGetDemoCollectStatus('cCompleteAlready')) and (not event_flags_system['cPlayer:CompleteInsects'])):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:002', false)
        Player.PlayerPlayCompleteAnimation()
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:003', false)
        Player.PlayerWaitAsFinish()
        event_flags_system['cPlayer:CompleteInsects'] = true
    run sub_tm!Get_CatchInsectCompleteDemo

flow Get_Fish:
    if (Player.PlayerGetDemoCheckItem('cTrash')) or (Player.PlayerGetDemoCheckItem('cOre')):
        run sub_Event9
    elif Player.PlayerGetDemoCheckItem('cFishEgg'):
        run Player_GetDemo_Easter::GetWaterEgg
    elif EventFlowSystemActor.NetIsDreaming():
        EventFlowSystemActor.SetTagFromSystem(0, 'cChachFish', 'cDegit', '', 0)
        Player.OpenMessageWindow('TalkSys/SYS_Get_Fish:021', false)
        run sub_grp!Event32
    elif Player.PlayerGetDemoCollectStatus('cFirstGet'):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Fish:001', false)
        run sub_Event166
    elif not Player.PlayerGetDemoCheckItem('cDojou'):
entrypoint Event6:
        Player.PlayerOpenFishGetMessage()
        run Get_CatchFishCompleteDemo
        run sub_grp!Event32
    elif event_flags_system['cPlayer:Got2ndLoach']:
        run sub_Event166
    else:
        run Player_GetDemo_20_Fishing::Fishing_Get_2ndLoach
        run Get_CatchFishCompleteDemo
        run sub_grp!Event32
    return

flow Get_FishFes:
    EventFlowSystemActor.SetTagFromSystem(0, 'cChachFish', '"cDegit"', '""', 0)
    Player.OpenMessageWindow('TalkSys/SYS_Get_Insect_Fish_Fes:002', true)
    run Get_CatchFishCompleteDemo
    return

flow Get_GulParts:
    if Player.PlayerCheckAI('cGetDemo_ScoopFullItem'):
        Player.OpenMessageWindow('TalkSys/SYS_Player:002', false)
        if Player.PlayerHasExchaneableItem(false, true, true, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:006', true)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByScoop', '', 'cScoopDigFull', false)
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:016', true)
    else:
        Player.OpenMessageWindow('TalkSys/SYS_Get_ShellFish:100', false)
    return

flow Get_Insect:
    if (Player.PlayerGetDemoCheckItem('cSnowCrystal')) or (Player.PlayerGetDemoCheckItem('cSakurapetal')) or (Player.PlayerGetDemoCheckItem('cAutumnLeaf')):
        run sub_Event112
    elif Player.PlayerGetDemoCheckItem('cYutaroWisp'):
        run Get_YutaroWisp
    elif EventFlowSystemActor.NetIsDreaming():
        EventFlowSystemActor.SetTagFromSystem(0, 'cChachInsect', 'cDegit', '', 0)
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:301', false)
        run sub_grp!Event41
    elif Player.PlayerGetDemoCollectStatus('cFirstGet'):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:001', false)
        Player.PlayerOpenInsectGetMessage()
        run Get_CatchInsectCompleteDemo
        run sub_grp!Event41
    else:
        Player.PlayerOpenInsectGetMessage()
        run Get_CatchInsectCompleteDemo
        run sub_grp!Event41
    return

flow Get_InsectFes:
    EventFlowSystemActor.SetTagFromSystem(0, 'cChachInsect', '"cDegit"', '""', 0)
    Player.OpenMessageWindow('TalkSys/SYS_Get_Insect_Fish_Fes:001', true)
    run Get_CatchInsectCompleteDemo
    return

flow Get_Insect_Nukegara:
    if Player.PlayerHasExchaneableItem(false, true, true, true):
        Player.OpenMessageWindow('TalkSys/SYS_Player:006', true)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            Player.PlayerPlayPutawayWaitAnimation()
            EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByHarvest', '', 'cInsectGetFull', false)
    else:
        Player.OpenMessageWindow('TalkSys/SYS_Player:016', true)
    return

flow Get_LostQuest:
    Player.OpenMessageWindow('TalkSys/SYS_Player:101', false)
    if Player.PlayerCheckAI('cGetDemo_PickupFullItem'):
        run Event73
    else:
        event_flags_system['cLand:LostPropertyFound'] = true
    return

flow Get_Pickup:
    EventFlowSystemActor.SetTagFromSystem(0, 'cPlayerGetItemName', '"cDegit"', '""', 0)
    if Player.PlayerGetDemoCheckItem('cLostItem'):
        run Get_LostQuest
    elif Player.PlayerCheckAI('cGetDemo_PickupFullItem'):
entrypoint Event73:
        if Player.PlayerHasExchaneableItem(false, true, true, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:001', true)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByPickup', '', 'cPickupFull', false)
                if (EventFlowSystemActor.UIResultMenuDecide()) and (Player.PlayerGetDemoCheckItem('cLostItem')):
                    event_flags_system['cLand:LostPropertyFound'] = true
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:015', false)
    return

flow Get_Scoop:
    EventFlowSystemActor.SetTagFromSystem(0, 'cPlayerGetItemName', '"cDegit"', '""', 0)
    if Player.PlayerGetDemoCheckItem('cTreasure'):
        run Get_TreasureHunt
    elif Player.PlayerGetDemoCheckItem('cGatheringShellfish'):
        if EventFlowSystemActor.NetIsDreaming():
            Player.OpenMessageWindow('TalkSys/SYS_Get_ShellFish:201', false)
        else:
            event_flags_system['cLifeSupportAchievement:DigShell'] += 1
            Player.PlayerOpenShellFishGetMessage()
        if not Player.PlayerCheckAI('cGetDemo_ScoopFullItem'):
            subflow_results[1] = 1
            run Player_GetDemo_Recipe_DIY::ChumDIY_Chk
        elif Player.PlayerHasExchaneableItem(true, true, true, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:004', true)
entrypoint Event18:
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
entrypoint Event59:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByScoop', '', 'cScoopDigFull', false)
                if Player.PlayerGetDemoCheckItem('cGatheringShellfish'):
                    if EventFlowSystemActor.UIResultMenuDecide():
                        run Player_GetDemo_Recipe_DIY::ChumDIY_Chk
                elif Player.PlayerGetDemoCheckItem('cTreasure'):
                    if EventFlowSystemActor.UIResultMenuDecide():
                        run TreasureHunt_Finish
                elif (Player.PlayerGetDemoCheckItem('cPitfallSeed')) and (EventFlowSystemActor.UIResultMenuDecide()):
                    run Player_GetDemo_Recipe_DIY::PitFallDIY_Chk_AfterReplace
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:007', true)
    elif Player.PlayerGetDemoCheckItem('cJohnnyQuestByShellFish'):
        run Get_GulParts
    else:
        Player.OpenMessageWindow('TalkSys/SYS_Player:002', false)
        if Player.PlayerGetDemoCheckItem('cGroundEgg'):
            run Player_GetDemo_Easter::GetEarthEgg
        elif Player.PlayerGetDemoCheckItem('cPitfallSeed'):
            run Player_GetDemo_Recipe_DIY::PitFallDIY_Chk
        elif Player.PlayerCheckAI('cGetDemo_ScoopFullItem'):
entrypoint Event24:
            Player.OpenMessageWindow('TalkSys/SYS_Player:003', true)
entrypoint Event18:
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
entrypoint Event59:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByScoop', '', 'cScoopDigFull', false)
                if Player.PlayerGetDemoCheckItem('cGatheringShellfish'):
                    if EventFlowSystemActor.UIResultMenuDecide():
                        run Player_GetDemo_Recipe_DIY::ChumDIY_Chk
                elif Player.PlayerGetDemoCheckItem('cTreasure'):
                    if EventFlowSystemActor.UIResultMenuDecide():
                        run TreasureHunt_Finish
                elif (Player.PlayerGetDemoCheckItem('cPitfallSeed')) and (EventFlowSystemActor.UIResultMenuDecide()):
                    run Player_GetDemo_Recipe_DIY::PitFallDIY_Chk_AfterReplace
    run sub_tm!Get_Scoop

flow Get_SnowCrystal:
    if EventFlowSystemActor.NetIsDreaming():
        EventFlowSystemActor.SetTagFromSystem(0, 'cChachInsect', 'cDegit', '', 0)
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:302', false)
    else:
        Player.PlayerOpenInsectGetMessage()
    if Player.PlayerCheckAI('cGetDemo_InsectFullItem'):
        if Player.PlayerHasExchaneableItem(false, true, false, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:006', true)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByHarvest', '', 'cInsectGetFull', false)
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:016', true)
    return

flow Get_TreasureHunt:
    if not EventFlowSystemActor.IsMyVillage():
        Player.OpenMessageWindow('TalkSys/SYS_Player:100_01', true)
    elif EventFlowSystemActor.NpcQuestIsLimitOver('cTreasure'):
        event_flags_system['cPlayer:TreasurePlayerWin'] = false
        Player.OpenMessageWindow('TalkSys/SYS_Player:100', true)
        if Player.PlayerCheckAI('cGetDemo_ScoopFullItem'):
            run FullItem
        else:
entrypoint Event2:
            EventFlowSystemActor.UIMiniGameFinishAppear()
            EventFlowSystemActor.BGMPropertyControl(13)
            quest_flags['cTreasureFind'] = true
            EventFlowSystemActor.SetTreasureFindState()
    else:
        event_flags_system['cPlayer:TreasurePlayerWin'] = true
        Player.OpenMessageWindow('TalkSys/SYS_Player:100', true)
        if Player.PlayerCheckAI('cGetDemo_ScoopFullItem'):
            run FullItem
        else:
entrypoint Event2:
            EventFlowSystemActor.UIMiniGameFinishAppear()
            EventFlowSystemActor.BGMPropertyControl(13)
            quest_flags['cTreasureFind'] = true
            EventFlowSystemActor.SetTreasureFindState()
    return

flow Get_YutaroWisp:
    if EventFlowSystemActor.NetIsDreaming():
        EventFlowSystemActor.SetTagFromSystem(0, 'cChachInsect', 'cDegit', '', 0)
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:301', false)
    elif EventFlowSystemActor.HasTargetItem(4702, 4):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:204', false)
    elif EventFlowSystemActor.HasTargetItem(4702, 3):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:203', false)
    elif EventFlowSystemActor.HasTargetItem(4702, 2):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:202', false)
    elif EventFlowSystemActor.HasTargetItem(4702, 1):
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:201', false)
    else:
        Player.OpenMessageWindow('TalkSys/SYS_Get_Insect:200', false)
    if Player.PlayerCheckAI('cGetDemo_InsectFullItem'):
        if Player.PlayerHasExchaneableItem(false, true, true, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:006', true)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByHarvest', '', 'cInsectGetFull', false)
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:016', true)
    return

flow LostQuest_Cant_Receive:
    EventFlowSystemActor.SetTagFromSystem(0, 'cPlayerGetItemName', '"cDegit"', '""', 0)
    Player.OpenMessageWindow('TalkSys/SYS_Player:103', false)
    return

flow LostQuest_OtherVillage:
    EventFlowSystemActor.SetTagFromSystem(0, 'cPlayerGetItemName', '"cDegit"', '""', 0)
    Player.OpenMessageWindow('TalkSys/SYS_Player:102', false)
    return

flow TreasureHunt_Finish:
    run Event2
    return

flow sub_Event112:
    run Get_SnowCrystal

flow sub_Event166:
    run GetFish_NomalSeq

flow sub_Event9:
    run Player_GetDemo_20_Fishing::Fishing_Get_Trash

flow sub_grp!Event32:
    if Player.PlayerCheckAI('cGetDemo_FishFullItem'):
        if Player.PlayerHasExchaneableItem(false, true, true, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:004', true)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByHarvest', '', 'cFishGetFull', false)
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:007', true)

flow sub_grp!Event41:
    if Player.PlayerCheckAI('cGetDemo_InsectFullItem'):
        if Player.PlayerGetDemoCheckItem('cSeminonukegara'):
            run Get_Insect_Nukegara
        elif Player.PlayerHasExchaneableItem(false, true, true, true):
            Player.OpenMessageWindow('TalkSys/SYS_Player:004', true)
            if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                Player.PlayerPlayPutawayWaitAnimation()
                EventFlowSystemActor.UIItemSelectWindowHandling(65534, '', 'cExchangeByHarvest', '', 'cInsectGetFull', false)
        else:
            Player.OpenMessageWindow('TalkSys/SYS_Player:007', true)

flow sub_tm!Get_CatchFishCompleteDemo:
    return

flow sub_tm!Get_CatchInsectCompleteDemo:
    return

flow sub_tm!Get_Scoop:
    return

