flow Chk_HowManyType:
    if EventFlowSystemActor.HasTargetItem(2768, 30):
        entry_variables['BelongingCount'] += 1
        run SetWood
    if EventFlowSystemActor.HasTargetItem(2769, 30):
        entry_variables['BelongingCount'] += 1
        subflow_results[11] = 1
        run SetHardWood
    if EventFlowSystemActor.HasTargetItem(2767, 30):
        entry_variables['BelongingCount'] += 1
        subflow_results[11] = 2
        run SetSoftWood
    if EventFlowSystemActor.HasTargetItem(2511, 30):
        entry_variables['BelongingCount'] += 1
        subflow_results[11] = 3
        run SetIron
    if entry_variables['BelongingCount'] != 4:
        subflow_results[10] = 4
    elif entry_variables['BelongingCount'] != 3:
        subflow_results[10] = 3
    elif entry_variables['BelongingCount'] != 2:
        subflow_results[10] = 2
    elif entry_variables['BelongingCount'] == 1:
        subflow_results[10] = 0
    else:
        subflow_results[10] = 1
    return

flow Chk_Materials2:
    if EventFlowSystemActor.HasTargetItem(2768, 30):
        if EventFlowSystemActor.HasTargetItem(2769, 30):
            subflow_results[12] = 0
        elif EventFlowSystemActor.HasTargetItem(2767, 30):
            subflow_results[12] = 1
        else:
            subflow_results[12] = 2
    elif not EventFlowSystemActor.HasTargetItem(2769, 30):
        subflow_results[12] = 5
    elif EventFlowSystemActor.HasTargetItem(2767, 30):
        subflow_results[12] = 3
    else:
        subflow_results[12] = 4
    return

flow Chk_Materials3:
    if not EventFlowSystemActor.HasTargetItem(2768, 30):
        subflow_results[13] = 0
    elif not EventFlowSystemActor.HasTargetItem(2769, 30):
        subflow_results[13] = 1
    elif EventFlowSystemActor.HasTargetItem(2767, 30):
        subflow_results[13] = 3
    else:
        subflow_results[13] = 2
    return

flow Root:
    run Chk_HowManyType
    fEvent48 = subflow_results[10]
    if fEvent48 == 3:
        run Chk_Materials3
    elif fEvent48 == 2:
        run Chk_Materials2
    return

flow SetHardWood:
    if not event_flags_system['cLand:RcmShopMaterial_HardWood']:
        MainNpc.SetDeliveryItemAtRandom(2769, false, 'cVillageRemakePattern', 0)
    subflow_results[7] = 1
    subflow_results[11] = 1
    return

flow SetIron:
    if not event_flags_system['cLand:RcmShopMaterial_Iron']:
        MainNpc.SetDeliveryItemAtRandom(2511, false, 'cVillageRemakePattern', 0)
    subflow_results[7] = 3
    subflow_results[11] = 3
    return

flow SetSoftWood:
    if not event_flags_system['cLand:RcmShopMaterial_SoftWood']:
        MainNpc.SetDeliveryItemAtRandom(2767, false, 'cVillageRemakePattern', 0)
    subflow_results[7] = 2
    subflow_results[11] = 2
    return

flow SetWood:
    if not event_flags_system['cLand:RcmShopMaterial_Wood']:
        MainNpc.SetDeliveryItemAtRandom(2768, false, 'cVillageRemakePattern', 0)
    subflow_results[7] = 0
    subflow_results[11] = 0
    return

