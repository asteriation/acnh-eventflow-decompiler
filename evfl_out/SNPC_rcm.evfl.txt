flow Check:
    run Check_ShopEnable
    MainNpc.SetTwinsTag()
    event_flags_system['cPlayerTemp:RcmViaItemCheck'] = true
    if EventFlowSystemActor.IsMyVillage():
        run SNPC_rcm_03_RenualOpen::Chk_RenualOpen_Talk
        fEvent67 = subflow_results[1]
        if fEvent67 == 0:
            run SNPC_rcm_00_Common_ItemCheck::Root
        elif fEvent67 == 5:
            run SNPC_rcm_02_BeforeRenual::Rcm_BeforeRenualFor2
        elif fEvent67 == 3:
            run SNPC_rcm_03_RenualOpen::Rcm_RenualOpen2
            run SNPC_rcm_00_Common_ItemCheck::Root
        elif fEvent67 == 1:
            run SNPC_rcm_03_RenualOpen::Rcm_RenualOpen1
            run SNPC_rcm_00_Common_ItemCheck::Root
        elif fEvent67 == 4:
            run SNPC_rcm_00_In::Rcm_Market2_First
            run SNPC_rcm_00_Common_ItemCheck::Root
        elif fEvent67 == 2:
            run SNPC_rcm_00_In::Rcm_Market1_First
            run SNPC_rcm_00_Common_ItemCheck::Root
        run Rcm_SeqClose
    else:
        run SNPC_rcm_00_Common_ItemCheck::Root
    return

flow Check_Init:
    run EntrySubCast
    return

flow Check_ShopEnable:
    if EventFlowSystemActor.NetIsDreaming():
        EventFlowSystemActor.ExitFlowchart()
    return

flow EntrySubCast:
    if (EventFlowSystemActor.SystemCheckNowStage('cMametubu')) and (EventFlowSystemActor.ShopLevel() in (NooksCrannyInitial, NooksCrannyUpgraded)) and (not EventFlowSystemActor.NetIsConnected()):
        if MainNpc.NpcLabel('rcm'):
            MainNpc.NpcAITalkSubCastEntry(1, 'rct')
        else:
            MainNpc.NpcAITalkSubCastEntry(1, 'rcm')
    return

flow ForceRenualOpen:
    run SNPC_rcm_03_RenualOpen::Rcm_RenualOpen1_ConvHgh
    return

flow ForceRenualOpen_Init:
    MainNpc.NpcAITalkSubCastEntry(1, 'hgh')
    MainNpc.NpcAITalkSubCastEntry(2, 'rct')
    return

flow Not1stPlayer_ShopRequest:
    run Event3
    return

flow Rcm_SeqClose:
    run Event7
    return

flow Root:
    run Check_ShopEnable
    MainNpc.SetTwinsTag()
    if EventFlowSystemActor.IsMyVillage():
        run SNPC_rcm_03_RenualOpen::Chk_RenualOpen_Talk
        fEvent36 = subflow_results[1]
        if fEvent36 == 5:
            run SNPC_rcm_02_BeforeRenual::Rcm_BeforeRenualFor2
            run Rcm_SeqClose
        elif fEvent36 == 2:
            run SNPC_rcm_00_In::Rcm_Market1_First
            run Rcm_SeqClose
        elif fEvent36 == 4:
            run SNPC_rcm_00_In::Rcm_Market2_First
            run Rcm_SeqClose
        elif fEvent36 == 1:
            run SNPC_rcm_03_RenualOpen::Rcm_RenualOpen1
            run Rcm_SeqClose
        elif fEvent36 == 3:
            run SNPC_rcm_03_RenualOpen::Rcm_RenualOpen2
            run Rcm_SeqClose
        elif fEvent36 == 0:
            fEvent35 = EventFlowSystemActor.ShopLevel()
            if fEvent35 == NooksCrannyUpgraded:
                run SNPC_rcm_00_Common::Root
                run Rcm_SeqClose
            elif fEvent35 == NooksCrannyInitial:
                if event_flags_system['cPlayer:TwinTurnipExplanation']:
                    run SNPC_rcm_00_Common::Root
                else:
                    run SNPC_rcm_03_RenualOpen::Rcm_RenualOpen1
entrypoint Event7:
                event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                EventFlowSystemActor.UIMoneyDisappear()
                event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                EventFlowSystemActor.ExitFlowchart()
            elif fEvent35 == InResServiceTent:
                if not event_flags_system['cPlayer:RcmTalked1stAfterPrologue']:
                    run SNPC_rcm_01_Tent_0_1stShopping::Root
entrypoint Event7:
                    event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                    EventFlowSystemActor.UIMoneyDisappear()
                    event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                    event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                    event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                    event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                    EventFlowSystemActor.ExitFlowchart()
                elif EventFlowSystemActor.PlayerHouseLevel() in (0, 1):
entrypoint Event3:
                    run SNPC_rcm_00_Common::Root
                    run Rcm_SeqClose
                elif event_flags_system['cPlayer:MakeVillagePlayerFlag']:
                    if not event_flags_system['cPlayer:RcmTookQuestReq']:
                        run SNPC_rcm_01_Tent_1_Entries::Request
entrypoint Event7:
                        event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                        EventFlowSystemActor.UIMoneyDisappear()
                        event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                        event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                        event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                        event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                        EventFlowSystemActor.ExitFlowchart()
                    elif not event_flags_system['cLand:RcmShopMaterialComplete']:
                        run SNPC_rcm_01_Tent_1_Entries::Root
entrypoint Event7:
                        event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                        EventFlowSystemActor.UIMoneyDisappear()
                        event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                        event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                        event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                        event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                        EventFlowSystemActor.ExitFlowchart()
                    elif not event_flags_system['cPlayer:Prologue4RcmGetTent']:
                        run SNPC_rcm_00_Common::Root
entrypoint Event7:
                        event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                        EventFlowSystemActor.UIMoneyDisappear()
                        event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                        event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                        event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                        event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                        EventFlowSystemActor.ExitFlowchart()
                    elif event_flags_system['cPlayer:Prologue4RcmBuiltShop']:
                        run SNPC_rcm_00_Common::Root
entrypoint Event7:
                        event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                        EventFlowSystemActor.UIMoneyDisappear()
                        event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                        event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                        event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                        event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                        EventFlowSystemActor.ExitFlowchart()
                    else:
                        run SNPC_rcm_01_Tent_1_Entries::ReportTent
entrypoint Event7:
                        event_flags_system['cPlayerTemp:RcmTalkSceneFlag'] = true
                        EventFlowSystemActor.UIMoneyDisappear()
                        event_flags_system['cPlayer:RcmTalkBeforeFlag'] = true
                        event_flags_system['cPlayerTemp:RcmViaItemCheck'] = false
                        event_flags_system['cPlayerTemp:RcmShopshelfCheck'] = false
                        event_flags_system['cPlayerTemp:RcmBoughtGrocery'] = false
                        EventFlowSystemActor.ExitFlowchart()
                else:
                    run Not1stPlayer_ShopRequest
    else:
        run SNPC_rcm_00_Common::Root
        run Rcm_SeqClose
    return

flow Root_Init:
    run EntrySubCast
    return

