flow AI_owl_changeawake:
    run Event24
    return

flow AI_owl_changesleep:
    run Event12
    return

flow AI_owl_day:
    MainNpc.NpcDisableServiceMotion()
    if (MainNpc.CheckCurrentNpcAIState('cOwlSleep') == 0) or (MainNpc.NpcCheckStateSelectTiming('cInit')):
entrypoint Event12:
        MainNpc.NpcChangeAIState('cOwlSleep', 'SNPC_owl', 'Root', '', false, true)
        MainNpc.NpcAISetting(14, true)
        MainNpc.NpcChangeHeadCtrlMode('cNoLook', true)
        MainNpc.NpcSetAIBlackBoard('IsSleep', 1)
        MainNpc.NpcAISetting(3, false)
        MainNpc.NpcAISetting(2, false)
        MainNpc.SetDefaultWaitAs('cMaReSleep')
    elif MainNpc.PlayerFind():
        run AI_owl_changeawake
    else:
        MainNpc.NpcChangeAIState('cOwlSleepy', 'SNPC_owl', 'Root', '', false, true)
entrypoint Event41:
        MainNpc.SetDefaultWaitAs('cDefault')
        MainNpc.NpcAISetting(14, false)
        MainNpc.NpcChangeHeadCtrlMode('cPlayer', true)
        MainNpc.NpcSetAIBlackBoard('IsSleep', 0)
        MainNpc.NpcAISetting(3, true)
        MainNpc.NpcAISetting(2, true)
    return

flow AI_owl_night:
    if (MainNpc.CheckCurrentNpcAIState('cOwlWait') != 0) and (not MainNpc.NpcCheckStateSelectTiming('cInit')) and (MainNpc.NpcBlackBoard('IsSleep', 1)):
        MainNpc.NpcChangeAIState('cOwlAwake', 'SNPC_owl', 'Root', '', false, true)
        run Event41
    else:
entrypoint Event24:
        MainNpc.NpcChangeOwlWaitState('cOwlWait', 'Root', 'SNPC_owl', '', true, true, '', true, 150)
        run Event41
    return

flow Init:
    MainNpc.NpcRegistAIBlackBoard('IsSleep', 0)
    MainNpc.NpcAISetting(0, true)
    MainNpc.NpcAISetting(1, true)
    MainNpc.NpcAISetting(8, true)
    MainNpc.NpcAISetting(2, false)
    return

flow Root:
    if MainNpc.NpcCheckStateSelectTiming('cTalkEnd'):
        MainNpc.NpcAISetting(14, false)
        MainNpc.NpcChangeOwlPostTalkState('cOwlPostTalk', 'Root', 'SNPC_owl', '', false, true, 30)
        MainNpc.NpcChangeHeadCtrlMode('cPlayer', true)
    elif MainNpc.CheckCurrentNpcAIState('cOwlPostTalk') == 0:
        MainNpc.NpcChangeTurnDefaultState('cTurn', '', 'Root', 'SNPC_owl', true, true, false, 2, 0.0, '')
        MainNpc.NpcChangeHeadCtrlMode('cNoLook', true)
    elif (not EventFlowSystemActor.NetIsDreaming()) and (not EventFlowSystemActor.NetIsConnected()) and (MainNpc.CheckCurrentNpcAIState('cTurn') != 0):
        fEvent48 = EventFlowSystemActor.MuseumLevel()
        if fEvent48 == BlathersTent:
            run sub_Event40
        elif fEvent48 in (BlathersMuseumNoArt, BlathersMuseumArt):
            if MainNpc.CheckCurrentNpcAIState('cOwlSleepy') == 0:
                run AI_owl_changesleep
            elif MainNpc.CheckCurrentNpcAIState('cOwlAwake') == 0:
                run AI_owl_changeawake
            else:
                fEvent0 = EventFlowSystemActor.EnvHourTwentyFour()
                if fEvent0 in (0, 1, 2, 3, 4):
                    run AI_owl_night
                elif fEvent0 in (18, 19, 20, 21, 22, 23):
                    run AI_owl_night
                elif fEvent0 in (5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17):
                    run AI_owl_day
    else:
        run sub_Event40
    return

flow sub_Event40:
    run AI_owl_changeawake

