flow BuySelect:
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        EventFlowSystemActor.MessageSuspend()
        EventFlowSystemActor.SonkatsuBuyDone(false)
        EventFlowSystemActor.WaitFrame(15)
    else:
        run ReChangeItem
    return

flow ChkPocket40:
    if (event_flags_system['cPlayer:UpgradePocket30']) and (EventFlowSystemActor.OfficeLevel() == ResServiceBuilding):
        event_flags_system['cPlayer:SellPocket40'] = true
    return

flow Cmn_AppUpdateDemo:
    Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:061', true)
    run RecipeReceiveing1_Receive
    if subflow_results[2] in (0, 1):
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:062', false)
    else:
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:063', false)
    return

flow Cmn_PrintOutDemo:
    EventFlowSystemActor.WaitFrame(10)
    fork:
        branch0:
        branch1:
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:025', true)
        branch2:
            GeneralObject.StartAnimation('PrintOut', 'cHold')
    EventFlowSystemActor.WaitFrame(20)
    return

flow ExchangeCancel:
    Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:015', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        run ReChangeItem
    else:
        run Obj_RcoMachine::SelExit
    return

flow ExchangeDIYRecipeCard:
    if event_flags_system['cPlayer:MainmenuRecipe']:
        if EventFlowSystemActor.HasCraftRecipeSelectFlow('cItemSelect'):
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:027', false)
        else:
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:028', false)
        if EventFlowSystemActor.GeneralTalkChoice2() != 0:
            run ReChangeItem
        elif EventFlowSystemActor.ShoppingCapacity(5794, 'cItemName'):
            EventFlowSystemActor.SonkatsuBuyDone(true)
            run Cmn_PrintOutDemo
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:029', true)
            Player.PlayerChangeDemoState('cTicketTake')
            run RcoMachineMileExchangeAgain
        else:
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:024', false)
    else:
entrypoint Event68:
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:030', false)
        run RcoMachineMileExchangeAgain
    return

flow ExchangeHowToBook:
    run Obj_RcoMachine_MileExchange_Process::MileExchange_SetHowtoItem
    if (any (9221, 65534, 65534, 65534, 65534, 65534, 65534, 65534) in EventFlowSystemActor.ItemSelect('cItemSelect')) and (not event_flags_system['cPlayer:MainmenuRecipe']):
        run RcoMachine_Cmn_NoDIY
    else:
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:012', false)
        if EventFlowSystemActor.GeneralTalkChoice2() == 0:
            EventFlowSystemActor.MessageSuspend()
            EventFlowSystemActor.SonkatsuBuyDone(false)
            fEvent17 = subflow_results[2]
            if fEvent17 == 0:
                run Cmn_PrintOutDemo
                Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:031', true)
                Player.PlayerChangeDemoState('cTicketTake')
                fEvent59 = subflow_results[1]
                if fEvent59 == 0:
                    EventFlowSystemActor.ReservePlayerTicketGetDemo('Player_GetDemo_MileExchange', 'Get_Hair_Pop')
                elif fEvent59 == 1:
                    EventFlowSystemActor.ReservePlayerTicketGetDemo('Player_GetDemo_MileExchange', 'Get_Hair_Cool')
                elif fEvent59 == 2:
                    EventFlowSystemActor.ReservePlayerTicketGetDemo('Player_GetDemo_MileExchange', 'Get_Hair_Color')
                elif fEvent59 == 3:
                    EventFlowSystemActor.ReservePlayerTicketGetDemo('Player_GetDemo_MileExchange', 'Get_Pocket30')
                elif fEvent59 == 4:
                    EventFlowSystemActor.ReservePlayerTicketGetDemo('Player_GetDemo_MileExchange', 'Get_Pocket40')
                elif fEvent59 == 5:
                    EventFlowSystemActor.ReservePlayerTicketGetDemo('Player_GetDemo_MileExchange', 'Get_ItemRing')
                EventFlowSystemActor.ExitFlowchart()
            elif fEvent17 == 1:
                run MileExchange_GetApp_MyDesignPRO
            elif fEvent17 == 2:
                run MileExchange_Get_ToolRecipesData
        else:
            run ReChangeItem
    return

flow ExchangeMilePlaneTicket:
    if (not any (9964, 65534, 65534, 65534, 65534, 65534, 65534, 65534) in EventFlowSystemActor.ItemSelect('cItemSelect')) and (not event_flags_system['cPlayer:DodExplainAboutMysteryTour']) and (not event_flags_system['cPlayer:RcoMachineExplainAboutPlaneTicket']):
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:021', false)
        event_flags_system['cPlayer:RcoMachineExplainAboutPlaneTicket'] = true
    Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:012', false)
    if EventFlowSystemActor.GeneralTalkChoice2() != 0:
        run ReChangeItem
    elif any (9964, 65534, 65534, 65534, 65534, 65534, 65534, 65534) in EventFlowSystemActor.ItemSelect('cItemSelect'):
        if EventFlowSystemActor.ShoppingCapacity(9964, 'cItemName'):
            EventFlowSystemActor.MessageSuspend()
            EventFlowSystemActor.SonkatsuBuyDone(true)
            run Cmn_PrintOutDemo
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:026_02', true)
            Player.PlayerChangeDemoState('cTicketTake')
            run RcoMachineMileExchangeAgain
        else:
            Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:024', false)
    elif EventFlowSystemActor.ShoppingCapacity(5851, 'cItemName'):
        EventFlowSystemActor.MessageSuspend()
        EventFlowSystemActor.SonkatsuBuyDone(true)
        run Cmn_PrintOutDemo
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:026_01', true)
        Player.PlayerChangeDemoState('cTicketTake')
        run RcoMachineMileExchangeAgain
    else:
        Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:024', false)
    return

flow MileExchange_Cmn_Sel:
    Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:012', false)
    run BuySelect
    return

flow MileExchange_GetApp_MyDesignPRO:
    run Cmn_AppUpdateDemo
    run RecipeReceiveing2_End
    EventFlowSystemActor.ReservePlayerMutterDemo('Get_App_MydesignPRO', 'cNowDemoEnd', 'Player_GetDemo_MileExchange', true)
    EventFlowSystemActor.ExitFlowchart()
    return

flow MileExchange_Get_ToolRecipesData:
    run Cmn_AppUpdateDemo
    run RecipeReceiveing2_End
    EventFlowSystemActor.ReservePlayerMutterDemo('Get_Reipe_Tools', 'cNowDemoEnd', 'Player_GetDemo_MileExchange', true)
    EventFlowSystemActor.ExitFlowchart()
    return

flow MileExchange_MyDesignPRO2:
    run Cmn_AppUpdateDemo
    run RecipeReceiveing2_End
    EventFlowSystemActor.ReservePlayerMutterDemo('Get_MydesignPRO2', 'cNowDemoEnd', 'Player_GetDemo_MileExchange', true)
    EventFlowSystemActor.ExitFlowchart()
    return

flow RcoMachineMileExchangeAgain:
    run Event26
    return

flow RcoMachine_Cmn_NoDIY:
    run Event68
    return

flow ReChangeItem:
    run Event9
    return

flow ReceiveConstructionLisence:
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.SonkatsuBuyDone(false)
    run Cmn_AppUpdateDemo
    run RecipeReceiveing2_End
    run Obj_RcoMachine_MileExchange_Process::ReceiveLisenceEnable
    return

flow RecipeReceiveing1_Receive:
    EventFlowSystemActor.WaitFrame(15)
    Player.SmartPhone(0)
    EventFlowSystemActor.WaitFrame(15)
    Player.SmartPhone(4)
    EventFlowSystemActor.WaitFrame(30)
    Player.SmartPhoneSE('Phone_Recieving', 2)
    EventFlowSystemActor.WaitFrame(15)
    Player.SmartPhone(5)
    return

flow RecipeReceiveing2_End:
    EventFlowSystemActor.WaitFrame(15)
    Player.SmartPhone(1)
    return

flow Root:
    run ChkPocket40
    EventFlowSystemActor.UISonkatsuPointAppear()
entrypoint Event9:
    EventFlowSystemActor.MessageSuspend()
    EventFlowSystemActor.UIShopBuyHandling('cSonkatsuPoint')
    if EventFlowSystemActor.UIResultMenuDecide():
        EventFlowSystemActor.SetTagFromUIResult(0, 'cItemName')
        EventFlowSystemActor.SetTagFromUIResult(0, 'cLifeSupportPoint')
        if any ('MilePlaneTicket', '', '', '', '', '', '', '') in EventFlowSystemActor.ItemSelect('cItemSelect'):
            run ExchangeMilePlaneTicket
        elif any ('DummyHowtoBook', '', '', '', '', '', '', '') in EventFlowSystemActor.ItemSelect('cItemSelect'):
            run ExchangeHowToBook
        elif any ('DIYRecipe', '', '', '', '', '', '', '') in EventFlowSystemActor.ItemSelect('cItemSelect'):
            run ExchangeDIYRecipeCard
        else:
            if any ('LicenseItem', '', '', '', '', '', '', '') in EventFlowSystemActor.ItemSelect('cItemSelect'):
                Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:013', false)
            else:
                Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:012', false)
            if EventFlowSystemActor.GeneralTalkChoice2() != 0:
                run ReChangeItem
            elif any ('LicenseItem', '', '', '', '', '', '', '') in EventFlowSystemActor.ItemSelect('cItemSelect'):
                run ReceiveConstructionLisence
            else:
                EventFlowSystemActor.SonkatsuBuyDone(false)
                EventFlowSystemActor.MilagePackageSend()
                Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:014', false)
entrypoint Event26:
                Player.OpenMessageWindow('TalkObj/OBJ_RcoMachine:015', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    run ReChangeItem
                else:
                    run Obj_RcoMachine::SelExit
    else:
        EventFlowSystemActor.UISonkatsuPointDisappear()
        run Obj_RcoMachine::RcoSelSeq
    return

