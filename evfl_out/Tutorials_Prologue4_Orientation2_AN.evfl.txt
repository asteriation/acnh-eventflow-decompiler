flow Prologue_NnpcTentChk:
    run Event8
    return

flow Root:
    MainNpc.SetNpcName(0, 13)
    if not event_flags_system['cPlayer:PrologueDone1stTalkAtPlaza']:
        if MainNpc.NpcBlackBoard('ArrivePlaza', 1):
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:002', false)
        else:
            fEvent61 = EventFlowSystemActor.RandomChoiceExcludePrevious3(false, 3)
            if fEvent61 == 0:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:000_01', false)
            elif fEvent61 == 1:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:000_02', false)
            elif fEvent61 == 2:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:000_03', false)
    elif event_flags_system['cPlayer:PrologueStartedCampfire']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:101', false)
    elif event_flags_system['cPlayer:PrologueAfterBuiltTentTalk']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue_FreeTalk_AN:001', false)
    elif event_flags_system['cLand:Prologue4BuiltNpcAN']:
        if not event_flags_system['cPlayer:Prologue4AnGetTent']:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:021', false)
        elif event_flags_system['cPlayer:Prologue4AnBuiltTent']:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:024', false)
            if event_flags_system['cPlayer:Prologue4HaGetTent']:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:025_02', false)
            else:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:025_01', false)
        else:
            event_flags_system['cPlayer:Prologue4AnBuiltTent'] = true
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:022', false)
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:023', false)
            run Prologue_NnpcTentChk
    elif event_flags_system['cPlayer:Prologue4AnGetTent']:
        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:013', false)
    else:
        if not event_flag_npc['cNpcMemory:FirstMeetGreetAtThisVillage']:
            event_flags_npc['cNpcMemory:FirstMeetGreetAtThisVillage'] = true
            event_flags_npc['cNpcMemory:FirstMeetGreetAtThisVillageToday'] = true
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:001', false)
        if not event_flags_system['cPlayer:PlayerPocketUIEnable']:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:002', false)
        elif event_flags_system['cLand:Prologue4BuiltPlayer']:
            if event_flags_system['cPlayer:Prologue4AnNoTent']:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:014', false)
            else:
                event_flags_system['cPlayer:Prologue4AnNoTent'] = true
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:004', false)
            MainNpc.SetDeliveryItem(3, true)
            fEvent3 = EventFlowSystemActor.GeneralTalkChoice3()
            if fEvent3 == 2:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:009', false)
            elif fEvent3 == 1:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:011', true)
                MainNpc.NpcDelivery('Keep', 1)
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:012', false)
                MainNpc.NpcDelivery('"Default"', 2)
                event_flags_system['cPlayer:Prologue4AnGetTent'] = true
                MainNpc.NpcSetAIBlackBoard('HasTent', 0)
                MainNpc.NpcSetAIBlackBoard('BuildingSiteIndex', -1)
            elif fEvent3 == 0:
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:005', true)
                run System_Structure_Common::PreviewStructure
                MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:006', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:007', true)
                    run System_Structure_Common::DeletePreviewAndBuildStructureInNpcTalk
                    MainNpc.SetItemName(0, 3, 0)
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:008_01', false)
                    event_flags_system['cLand:Prologue4BuiltNpcAN'] = true
entrypoint Event8:
                    if event_flags_system['cLand:Prologue4BuiltNpcHA']:
                        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:008_02', true)
                        Player.TurnNeck(11)
                        EventFlowSystemActor.WaitFrame(10)
                        EventFlowSystemActor.SetNpcAIBlackBoardByLabel('isSpeak', 1, 'rco', 1)
                    elif event_flags_system['cPlayer:Prologue4HaGetTent']:
                        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:025_02', false)
                    else:
                        MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:008_03', false)
                else:
                    MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:010', true)
                    run System_Structure_Common::DeletePreviewStructureInNpcTalk
        else:
            MainNpc.OpenMessageWindow('Tutorials/Tutorials_Prologue4_Orientation2_AN:003', false)
    return

