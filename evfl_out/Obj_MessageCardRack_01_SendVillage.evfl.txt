flow EntryPoint_EditNPC:
    run Event54
    return

flow EntryPoint_EditPlayer:
    run Event54
    return

flow EntryPoint_SendVillage:
    EventFlowSystemActor.UIMoneyDisappear()
    DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:200', false)
    EventFlowSystemActor.UIMsgCardAdrHandling('cResident')
    if not EventFlowSystemActor.UIResultMenuDecide():
        run Obj_MessageCardRack::EntryPoint_CancelNega
    elif EventFlowSystemActor.UIIsAdrSelect():
        if EventFlowSystemActor.HasFreeInPostOffice('cToVillagePlayer'):
            EventFlowSystemActor.SetTagFromUIResult(0, 'cSelectPlayerName')
            DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:210_01', false)
            run sub_grp!Event48
        else:
            run Obj_MessageCardRack::EntryPoint_StockFull
    elif EventFlowSystemActor.HasFreeInPostOffice('cToNpc'):
        EventFlowSystemActor.SetTagFromUIResult(0, 'cSelectNpcName')
        DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:210_02', false)
        run sub_grp!Event48
    else:
        run Obj_MessageCardRack::EntryPoint_StockFull
    return

flow sub_grp!Event48:
    if EventFlowSystemActor.ExistUnfinishMail():
        EventFlowSystemActor.ChangeAddressUnfinishMail()
        DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:220_02', false)
entrypoint Event54:
        EventFlowSystemActor.UIMoneyDisappear()
        EventFlowSystemActor.UIMsgCardEditTextHandling('')
        if not EventFlowSystemActor.UIResultMenuDecide():
            run Obj_MessageCardRack::EntryPoint_EditCancel
        elif EventFlowSystemActor.HasFreeInPostOffice('cToVillagePlayer'):
            EventFlowSystemActor.UIMoneyAppear()
            EventFlowSystemActor.SaveSetFromUIResult('cMsgCard')
            if EventFlowSystemActor.HasBellCount(200):
                DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:500', true)
                EventFlowSystemActor.BellCountDown(-200, False)
                EventFlowSystemActor.DropIntoPostOffice('cSaveMailUserInfo')
                DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:501', false)
                EventFlowSystemActor.UIMoneyDisappear()
            else:
                DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:510', false)
                EventFlowSystemActor.UIMoneyDisappear()
                run Obj_MessageCardRack::EntryPoint_EditKeepByNoMoney
        else:
            run Obj_MessageCardRack::EntryPoint_StockFull
    else:
        DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:220_01', false)
        EventFlowSystemActor.UIMoneyDisappear()
        EventFlowSystemActor.UIMsgCardSelectHandling()
        if EventFlowSystemActor.UIResultMenuDecide():
entrypoint Event54:
            EventFlowSystemActor.UIMoneyDisappear()
            EventFlowSystemActor.UIMsgCardEditTextHandling('')
            if not EventFlowSystemActor.UIResultMenuDecide():
                run Obj_MessageCardRack::EntryPoint_EditCancel
            elif EventFlowSystemActor.HasFreeInPostOffice('cToVillagePlayer'):
                EventFlowSystemActor.UIMoneyAppear()
                EventFlowSystemActor.SaveSetFromUIResult('cMsgCard')
                if EventFlowSystemActor.HasBellCount(200):
                    DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:500', true)
                    EventFlowSystemActor.BellCountDown(-200, False)
                    EventFlowSystemActor.DropIntoPostOffice('cSaveMailUserInfo')
                    DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:501', false)
                    EventFlowSystemActor.UIMoneyDisappear()
                else:
                    DynamicCast_dod.OpenMessageWindow('TalkSNpc/dod/SP_dod_50_PostOffice:510', false)
                    EventFlowSystemActor.UIMoneyDisappear()
                    run Obj_MessageCardRack::EntryPoint_EditKeepByNoMoney
            else:
                run Obj_MessageCardRack::EntryPoint_StockFull
        else:
            run Obj_MessageCardRack::EntryPoint_CancelNega

