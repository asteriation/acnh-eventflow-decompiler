flow GulBAfterQuest:
    if event_flags_system['cLandTemp:GulBTalkShareplay']:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:120', false)
        EventFlowSystemActor.ExitFlowchart()
    else:
        run GulBAfterQuestChat
    return

flow GulBAfterQuestChat:
    fEvent209 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
    if fEvent209 == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:040_01', true)
    elif fEvent209 == 1:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:040_02', true)
    elif fEvent209 == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:040_03', true)
    MainNpc.SmartPhone(0)
    MainNpc.SmartPhone(4)
    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:041', true)
    MainNpc.SmartPhone(1)
    fEvent197 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
    if fEvent197 == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:042', false)
    elif fEvent197 == 1:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:043', false)
    elif fEvent197 == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:044', false)
    EventFlowSystemActor.ExitFlowchart()
    return

flow GulBClear:
    if not event_flags_system['cPlayer:GulBQuestFinishFlag']:
        event_flags_system['cLifeSupportAchievement:HelpGul'] += 1
        event_flags_system['cPlayer:GulBHelpCount'] += 1
        event_flags_system['cPlayer:GulBQuestFinishFlag'] = true
        event_flags_system['cLand:JohnnyQuestFinishFlagIsland'] = true
    event_flags_system['cPlayer:GulBQuestStartFlag'] = false
    MainNpc.GulFreeAction('cGulActionType_SetAnotherPlayerClearFlag')
    event_flags_system['cLandTemp:GulBTalkShareplay'] = false
    return

flow GulBGivePartsForced:
    MainNpc.SetDeliveryItemAtRandom(13105, false, 'cVillageRemakePattern', 0)
    MainNpc.NpcDelivery('Keep', 0)
    MainNpc.GulFreeAction('cGulActionType_PresentPiratesParts')
    MainNpc.NpcDelivery('"Default"', 3)
    return

flow GulBKeepSleep:
    if not event_flags_system['cPlayer:GulBTalkBeforeFlag']:
        MainNpc.NpcChangeNameStatus(3)
    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:060', false)
    MainNpc.NpcChangeNameStatus(0)
    EventFlowSystemActor.ExitFlowchart()
    return

flow GulBQuestClear:
    run Event233
    return

flow GulBQuestNow:
    run Event32
    return

flow GulBQuestNow_OtherClear:
    run Event163
    return

flow GulBSitUp:
    if not event_flags_system['cPlayer:GulBTalkBeforeFlag']:
        MainNpc.NpcChangeNameStatus(3)
    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:065', true)
    MainNpc.NpcChangeNameStatus(0)
    MainNpc.SetDefaultWaitAs('cDefault')
    MainNpc.RequestSimple('GulGetUp', true)
    MainNpc.TurnBody(10, 0.0)
    event_flags_system['cLand:JohnnySitUpFlag'] = true
    return

flow GulBStart:
    if event_flags_system['cPlayer:GulBQuestStartFlag']:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:023', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:022', false)
    event_flags_system['cPlayer:GulBQuestStartFlag'] = true
    event_flags_system['cLandTemp:GulBTalkShareplay'] = true
    event_flags_system['cPlayer:GulBAnotherPlayerClearFlag'] = false
    return

flow GulBStartWithStanding:
    run Event158
    return

flow GulBTalkChk:
    if EventFlowSystemActor.IsMyVillage():
        event_flags_system['cPlayer:GulBTalkBeforeFlag'] = true
    return

flow GulBTalkSleep:
    if not event_flags_system['cPlayer:GulBTalkBeforeFlag']:
        MainNpc.NpcChangeNameStatus(3)
    fEvent191 = EventFlowSystemActor.RandomChoiceExcludePrevious10(10, true)
    if fEvent191 == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_01', false)
    elif fEvent191 == 1:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_02', false)
    elif fEvent191 == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_03', false)
    elif fEvent191 == 3:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_04', false)
    elif fEvent191 == 4:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_05', false)
    elif fEvent191 == 5:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_06', false)
    elif fEvent191 == 6:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_07', false)
    elif fEvent191 == 7:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_08', false)
    elif fEvent191 == 8:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_09', false)
    elif fEvent191 == 9:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:001_10', false)
    MainNpc.NpcChangeNameStatus(0)
    EventFlowSystemActor.ExitFlowchart()
    return

flow GulB_DC:
    if event_flags_system['cLand:JohnnySitUpFlag']:
        run GulBTalkChk
        if event_flags_system['cLandTemp:GulBTalkShareplay']:
            fEvent247 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
            if fEvent247 == 1:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:062_02', false)
            elif fEvent247 == 2:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:062_03', false)
            elif fEvent247 == 0:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:062_01', false)
        else:
            fEvent243 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
            if fEvent243 == 1:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:061_02', false)
            elif fEvent243 == 2:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:061_03', false)
            elif fEvent243 == 0:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:061_01', false)
    else:
        run GulBKeepSleep
    return

flow GulB_GetUp_NotStart:
    run GulBSitUp
    if MainNpc.GulFreeQuery2('cGulQueryType_OtherPlayerQuestNow'):
        if not event_flags_system['cPlayer:GulBTalkBeforeFlag']:
            MainNpc.NpcChangeNameStatus(3)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:100', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:101', true)
        run GulBTalkChk
        MainNpc.NpcChangeNameStatus(0)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:102', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:103', false)
    elif MainNpc.GulFreeQuery2('cGulQueryType_OtherPlayerClear'):
        if not event_flags_system['cPlayer:GulBTalkBeforeFlag']:
            MainNpc.NpcChangeNameStatus(3)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:100', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:101', true)
        run GulBTalkChk
        MainNpc.NpcChangeNameStatus(0)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:105', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:106', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:106_01', false)
        MainNpc.NpcStartAS('GulBLostPhone', true, False)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:107', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:108', false)
    elif event_flags_system['cPlayer:GulBSitUpBeforeFlag']:
        fEvent61 = EventFlowSystemActor.RandomChoice4(4)
        if fEvent61 == 0:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:005', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:006', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018', false)
            MainNpc.NpcStartAS('GulBLostPhone', true, False)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_01', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_02', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:019', false)
        elif fEvent61 == 1:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:008', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:009', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018', false)
            MainNpc.NpcStartAS('GulBLostPhone', true, False)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_01', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_02', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:019', false)
        elif fEvent61 == 2:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:011', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:012', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018', false)
            MainNpc.NpcStartAS('GulBLostPhone', true, False)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_01', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_02', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:019', false)
        elif fEvent61 == 3:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:014', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:015', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018', false)
            MainNpc.NpcStartAS('GulBLostPhone', true, False)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_01', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_02', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:019', false)
    elif event_flags_system['cPlayer:GulBTalkBeforeFlag']:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:002', true)
        event_flags_system['cPlayer:GulBSitUpBeforeFlag'] = true
        run GulBTalkChk
        MainNpc.NpcChangeNameStatus(0)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:003', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:004', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018', false)
        MainNpc.NpcStartAS('GulBLostPhone', true, False)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_01', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_02', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:019', false)
    else:
        MainNpc.NpcChangeNameStatus(3)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:002', true)
        event_flags_system['cPlayer:GulBSitUpBeforeFlag'] = true
        run GulBTalkChk
        MainNpc.NpcChangeNameStatus(0)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:003', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:004', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018', false)
        MainNpc.NpcStartAS('GulBLostPhone', true, False)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_01', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:018_02', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:019', false)
    if EventFlowSystemActor.GeneralTalkChoice2() == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:020', false)
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:021', false)
    run GulBStart
    EventFlowSystemActor.ExitFlowchart()
    return

flow GulB_GetUp_Start:
    run GulBSitUp
    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:080', false)
    if event_flags_system['cPlayer:GulBAnotherPlayerClearFlag']:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:112', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:113', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:113_01', false)
        MainNpc.NpcStartAS('GulBLostPhone', true, False)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:107', false)
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:114', false)
        run GulBStart
        EventFlowSystemActor.ExitFlowchart()
    else:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:110', false)
        run GulBStart
        EventFlowSystemActor.ExitFlowchart()
    return

flow GulB_NetHost:
    if event_flags_system['cLand:JohnnySitUpFlag']:
        run GulBTalkChk
        if event_flags_system['cPlayer:GulBQuestFinishFlag']:
            run GulBAfterQuestChat
        elif not event_flags_system['cPlayer:GulBQuestStartFlag']:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:067', false)
            EventFlowSystemActor.ExitFlowchart()
        elif EventFlowSystemActor.HasTargetItem(13105, 1):
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:066', false)
            run GulBGivePartsForced
            run GulBQuestClear
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:068', false)
            EventFlowSystemActor.ExitFlowchart()
    elif event_flags_system['cPlayer:GulBQuestFinishFlag']:
        run GulBKeepSleep
    elif not event_flags_system['cPlayer:GulBQuestStartFlag']:
        run GulBKeepSleep
    elif EventFlowSystemActor.HasTargetItem(13105, 1):
        run GulBSitUp
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:066', false)
        run GulBGivePartsForced
        run GulBQuestClear
    else:
        run GulBKeepSleep
    return

flow GulB_Share:
    if event_flags_system['cLand:JohnnySitUpFlag']:
        run GulBTalkChk
        if event_flags_system['cLandTemp:GulBTalkShareplay']:
            if event_flags_system['cPlayer:GulBQuestFinishFlag']:
                run GulBAfterQuest
            elif not event_flags_system['cPlayer:GulBQuestStartFlag']:
entrypoint Event158:
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:121', false)
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:122', false)
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:123', false)
                run GulBStart
                EventFlowSystemActor.ExitFlowchart()
            elif event_flags_system['cPlayer:GulBAnotherPlayerClearFlag']:
                run GulBQuestNow_OtherClear
            else:
                run GulBQuestNow
        elif event_flags_system['cPlayer:GulBQuestFinishFlag']:
            run GulBAfterQuestChat
        elif event_flags_system['cPlayer:GulBQuestStartFlag']:
entrypoint Event163:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:126', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:112', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:127', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:127_01', false)
            MainNpc.NpcStartAS('GulBLostPhone', true, False)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:128', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:128_01', false)
            run GulBStart
            EventFlowSystemActor.ExitFlowchart()
        else:
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:121', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:125', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:112', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:127', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:127_01', false)
            MainNpc.NpcStartAS('GulBLostPhone', true, False)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:128', false)
            MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:128_01', false)
            run GulBStart
            EventFlowSystemActor.ExitFlowchart()
    elif event_flags_system['cPlayer:GulBQuestFinishFlag']:
        run GulBKeepSleep
    elif event_flags_system['cPlayer:GulBQuestStartFlag']:
        run GulB_GetUp_Start
    else:
        run GulB_GetUp_NotStart
    return

flow Root:
    if EventFlowSystemActor.IsSharePlay(0):
        run GulB_Share
    elif not EventFlowSystemActor.IsMyVillage():
        run GulB_DC
    elif EventFlowSystemActor.NetHasVisitor():
        run GulB_NetHost
    elif event_flags_system['cLand:JohnnySitUpFlag']:
        run GulBTalkChk
        if event_flags_system['cPlayer:GulBQuestFinishFlag']:
            run GulBAfterQuest
        elif event_flags_system['cPlayer:GulBQuestStartFlag']:
entrypoint Event32:
            if EventFlowSystemActor.HasTargetItem(13105, 1):
                MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:030', false)
                if EventFlowSystemActor.GeneralTalkChoice2() == 0:
                    MainNpc.SetDeliveryItemAtRandom(13105, false, 'cVillageRemakePattern', 0)
                    MainNpc.NpcDelivery('Keep', 0)
                    MainNpc.GulFreeAction('cGulActionType_PresentPiratesParts')
                    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:032', true)
                    MainNpc.NpcDelivery('"Default"', 3)
entrypoint Event233:
                    EventFlowSystemActor.WaitFrame(4)
                    MainNpc.CharacterEmoticonAction('Dance', '', 0, false, false)
                    EventFlowSystemActor.WaitFrame(60)
                    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:033', true)
                    MainNpc.SmartPhone(0)
                    MainNpc.SmartPhone(4)
                    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:036', true)
                    MainNpc.SmartPhone(1)
                    MainNpc.DecideEventReward('cGulBReward')
                    MainNpc.SetDeliveryItem(1, true)
                    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:034', false)
                    MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:035', true)
                    run GulBClear
                    fEvent259 = EventFlowSystemActor.RandomChoice5(5)
                    if fEvent259 == 0:
                        EventFlowSystemActor.SystemMailSend('cGulB', 'MAIL_SNpc_gulB', 'cFastTomorrow', 'cReward', 'cNone', false, 1)
                    elif fEvent259 == 1:
                        EventFlowSystemActor.SystemMailSend('cGulB', 'MAIL_SNpc_gulB', 'cFastTomorrow', 'cReward', 'cNone', false, 2)
                    elif fEvent259 == 2:
                        EventFlowSystemActor.SystemMailSend('cGulB', 'MAIL_SNpc_gulB', 'cFastTomorrow', 'cReward', 'cNone', false, 3)
                    elif fEvent259 == 3:
                        EventFlowSystemActor.SystemMailSend('cGulB', 'MAIL_SNpc_gulB', 'cFastTomorrow', 'cReward', 'cNone', false, 4)
                    elif fEvent259 == 4:
                        EventFlowSystemActor.SystemMailSend('cGulB', 'MAIL_SNpc_gulB', 'cFastTomorrow', 'cReward', 'cNone', false, 5)
                else:
                    run sub_grp!Event192
            else:
                run sub_grp!Event192
        else:
            run GulBStartWithStanding
    elif event_flags_system['cPlayer:GulBQuestFinishFlag']:
        run GulBKeepSleep
    elif event_flags_system['cPlayer:GulBQuestStartFlag']:
        run GulB_GetUp_Start
    else:
        event_flags_system['cPlayer:JonnyTalkCount'] += 1
        if event_flags_system['cPlayer:JonnyTalkCount'] == 1:
            run GulBTalkSleep
        elif EventFlowSystemActor.PercentChoice(10):
            run GulB_GetUp_NotStart
        elif event_flags_system['cPlayer:JonnyTalkCount'] >= 6:
            run GulB_GetUp_NotStart
        else:
            run GulBTalkSleep
    return

flow sub_grp!Event192:
    fEvent192 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
    if fEvent192 == 0:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:031_01', false)
    elif fEvent192 == 1:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:031_02', false)
    elif fEvent192 == 2:
        MainNpc.OpenMessageWindow('TalkSNpc/gul/SP_gulB:031_03', false)

