flow Present_Chk:
    event_flags_system['cPlayerTemp:FreeISelectCount'] = 0
    if (not event_flags_system['cPlayer:TalkFreeIPresentTodayAnyone']) and (not event_flags_system['cPlayerTemp:TalkClothesPNow']) and (not Player.PlayerOutfitMarinesuit()) and (MainNpc.NpcHasFreeMessage('cFreeIPresent')):
entrypoint Event14:
        MainNpc.DecideFreeIType()
        MainNpc.DecideFreeIReward()
        if MainNpc.NpcIsRewardDecided():
            MainNpc.SetItemName(0, 27, 6)
            MainNpc.SetItemName(0, 27, 0)
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeI_Present:001', false)
            MainNpc.NpcOpenFreeMessage('cFreeIPresent')
            EventFlowSystemActor.MessageSuspend()
            MainNpc.SetDeliveryItem(27, true)
            MainNpc.NpcDelivery('"Default"', 1)
            MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeI_Present:002', false)
            event_flags_system['cPlayer:TalkFreeIPresentTodayAnyone'] = true
            event_flags_system['cPlayerTemp:TalkPresentNow'] = true
            MainNpc.RegistToReleaseItemList(2)
            EventFlowSystemActor.ExitFlowchart()
        elif event_flags_system['cPlayerTemp:FreeISelectCount'] < 5:
            event_flags_system['cPlayerTemp:FreeISelectCount'] += 1
            run ReSelect
    return

flow ReSelect:
    run Event14
    return

