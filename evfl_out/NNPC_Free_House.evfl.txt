flow BestFriend:
    if EventFlowSystemActor.PercentChoice(26):
        run NNPC_FreeC::Furniture_Chk
    if EventFlowSystemActor.PercentChoice(21):
        run NNPC_FreeC::Room_Chk
    if EventFlowSystemActor.PercentChoice(9):
        run NNPC_FreeA::Week_Chk
    if EventFlowSystemActor.PercentChoice(20):
        run NNPC_FreeA::ClothesN2_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeA::AlwaysAB_Chk
    if EventFlowSystemActor.PercentChoice(75):
        run NNPC_FreeA::Always_Chk
    run NNPC_FreeA::HouseQuestions_Chk
    return

flow Free_House1:
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeD::Rumor_Action_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeD::RumorN_Chk
    run Free_House2
    return

flow Free_House2:
    if EventFlowSystemActor.PercentChoice(25):
        run NNPC_FreeEF::Snpc_Chk
    if EventFlowSystemActor.PercentChoice(25):
        run NNPC_FreeA::ClothesN1_Chk
    if EventFlowSystemActor.PercentChoice(25):
        run NNPC_FreeA::ClothesP_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeEF::HHA_Chk
    run Free_House3
    return

flow Free_House3:
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeD::RumorO_Favorite_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeD::RumorP_Favorite_Chk
    if MainNpc.NpcIsSitting() not in (0, 1, 2, 3, 5):
        if EventFlowSystemActor.PercentChoice(20):
            run NNPC_FreeA::Want_Chk
        if (MainNpc.NpcIsSitting() not in (0, 1, 2, 3, 5)) and (EventFlowSystemActor.PercentChoice(20)):
            run NNPC_FreeI::Present_Chk
    run Free_House4
    return

flow Free_House4:
    event_flags_system['cPlayerTemp:NnpcTalkSelectCount'] = 0
entrypoint Event41:
    if event_flags_system['cPlayerTemp:NnpcTalkSelectCount'] >= 10:
        run ReSelect1
    else:
        event_flags_system['cPlayerTemp:NnpcTalkSelectCount'] += 1
        fEvent44 = MainNpc.CheckNpcFavorLevel()
        if fEvent44 in (0, 1):
            run BestFriend
        elif fEvent44 in (2, 3, 4):
            run GoodFriend
        elif fEvent44 == 5:
            run Friend
    return

flow Free_HouseG:
    MainNpc.SetNpcName(0, 15)
    fEvent82 = EventFlowSystemActor.RandomChoiceExcludePrevious3(true, 3)
    if fEvent82 == 0:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeC_RoomG:006', false)
    elif fEvent82 == 1:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeC_RoomG:007', false)
    elif fEvent82 == 2:
        MainNpc.OpenMessageWindow('TalkNNpc/B1_Bo/Free/BO_FreeC_RoomG:008', false)
    return

flow Free_HouseH:
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        run NNPC_FreeC::RoomN_withG
    else:
        run NNPC_FreeC::FunitureN_Chk
    return

flow Friend:
    if EventFlowSystemActor.PercentChoice(25):
        run NNPC_FreeC::Furniture_Chk
    if EventFlowSystemActor.PercentChoice(33):
        run NNPC_FreeC::Room_Chk
    if EventFlowSystemActor.PercentChoice(30):
        run NNPC_FreeA::Week_Chk
    if EventFlowSystemActor.PercentChoice(57):
        run NNPC_FreeA::ClothesN2_Chk
    run NNPC_FreeA::HouseQuestions_Chk
    return

flow GoodFriend:
    if EventFlowSystemActor.PercentChoice(25):
        run NNPC_FreeC::Furniture_Chk
    if EventFlowSystemActor.PercentChoice(27):
        run NNPC_FreeC::Room_Chk
    if EventFlowSystemActor.PercentChoice(18):
        run NNPC_FreeA::Week_Chk
    if EventFlowSystemActor.PercentChoice(18):
        run NNPC_FreeA::ClothesN2_Chk
    if EventFlowSystemActor.PercentChoice(67):
        run NNPC_FreeA::Always_Chk
    run NNPC_FreeA::HouseQuestions_Chk
    return

flow ReSelect1:
entrypoint Event88:
    if EventFlowSystemActor.RandomChoiceExcludePrevious2(2, true) == 0:
        if event_flags_npc['cNpcMemory:TalkReSelectLast'] == 2:
            run NNPC_FreeA::ReSelection_Week
        else:
            run ReSelect2
    elif event_flags_npc['cNpcMemory:TalkReSelectLast'] == 4:
        run NNPC_FreeC::Room_Chk
    else:
        run ReSelect2
    return

flow ReSelect2:
    run Event88
    return

flow ReSelection:
    run Event41
    return

flow Root:
    run NNPC_FreeD::Moving_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeH::Progress_InHouse_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeEF::FreeF_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeEF::Event_Chk
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeD::KeywordB
    if EventFlowSystemActor.PercentChoice(50):
        run NNPC_FreeD::KeywordA
    run Free_House1
    return

